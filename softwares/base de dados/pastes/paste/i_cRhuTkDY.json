{
 "espireDate": "1D",
 "format": "c",
 "jSonReasons": [
  "lg_vi"
 ],
 "key": "cRhuTkDY",
 "pasteDate": "Feb 28, 2018, 9:58:10 AM",
 "relevancy": 0.0,
 "relevant": false,
 "text": "/*\nTo 1 chng trnh c 4 chc nng\n- Nhn 1  thm cc tn+\n- Nhn 2  sp xp cc tn  c trong danh sch\n- Nhn 3  in ra cc tn trong danh sch hin c\n- Nhn 4  thot\nS dng mng cp pht ng\nS dng file  nhp v xut d liu\n*/\n\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <conio.h>\n#define MAX 100\n\nvoid Event1();\nvoid Event2();\nvoid Event3();\nvoid Event4();\nvoid Init ();\nvoid readFile();\nvoid writeFile();\nvoid resizeArr();\nint getNamePosition();\nvoid editLine();\n\n/*\nArr l mng danh sch cc tn\ncount l bin m s lng tn hin c\nmaxArr l bin lu gi tr s lng phn t Arr ln nht m b nh cp pht\n    nu dung lng phn t vt qu b nh cp pht th s tng bin maxArr\n    sau  cp pht li b nh cho Arr vi s lng phn t ln nht l bin maxArr mi\nline l mng c cp pht tnh  c ln lt cc tn  file\n    ty thuc vo  di tn ca line  cp pht b nh cho cc phn t mng Arr\n*/\nchar **Arr;\nint count, maxArr;\nchar line[150], oLine[150];\n\nint main (){\n    readFile();\n    int k;\n    while (1) {\n        Init();\n        printf (\"\\nNhap lenh cua ban (k = 1,2,3,4) k=\");\n        fflush(stdin); scanf (\"%d\",&k);\n        if (k == 1) Event1();\n        if (k == 2) Event2();\n        if (k == 3) Event3();\n        if (k == 4) Event4();\n    }\n    return 0;\n}\n\n/*\nThao tc c file, c ln lt tng dng t file v nhp vo mng Arr\nArr l con tr tr ti con tr, tr ti mng ang xt, mi bc c u kim tra xem s phn t c vt qu s lng Max ca mng khng\nNu vt qu th to ra 1 mng mi vi s lng phn t mng gp i s lng phn t mng ban u\nTrng hp nu  b nh  cp pht, s tin hnh cp pht b nh cho tng phn t mng Arr\nC 1 mng tnh loi char c khai bo trc, mng tnh ny s c gi tr t file\nTy thuc vo  di xu c c  cp pht b nh cho cc phn t mng Arr\n*/\nvoid readFile() {\n    FILE *file = fopen(\"input.txt\",\"a+\");\n    fscanf(file,\"%d\",&count); fgets(line,5,file);\n    count -= 1;\n    maxArr = count + 20;\n\n    // Cp pht b nh ng cho mng danh sch tn\n    Arr = (char**) malloc(maxArr*sizeof(char*));\n    if (Arr == NULL) {\n        printf(\"Khong du bo nho cap phat\");\n        fclose(file);\n        writeFile();\n    }\n\n    // c v cp pht b nh cho cc tn\n    for (int i = 0; i <= count; i++){\n        fgets(line,150,file);\n        Arr[i] = (char*) malloc (strlen(line)*sizeof(char));\n        if (Arr[i] == NULL) {\n            printf(\"Khong du bo nho cap phat\");\n            fclose(file);\n            writeFile();\n        }\n        strcpy(Arr[i],line);\n    }\n    // Cc xu tn u c 1 k t \\n  trc k t \\0, tuy nhin xu cui cng khng c nn lnh ny  thm \\n vo cui\n    if (count != -1) strcat(Arr[count],\"\\n\");\n    fclose(file);\n}\n\n/*\nThao tc in file\nTrong mi tn u c k t \\n ng cui, dng u tin  xa k t \\n ca tn cui cng\nLn lt in cc tn vo file, gii phng b nh v ng file\n*/\nvoid writeFile(){\n    Arr[count][strlen(Arr[count])-1] = '\\0';\n    FILE *file = fopen(\"input.txt\",\"w+\");\n    fprintf(file,\"%d\",count+1); fputs(\"\\n\",file);\n    for (int i = 0; i <= count; i++) fputs(Arr[i],file);\n    if (Arr != NULL) free(Arr);\n    fclose(file);\n    exit(0);\n}\n\nvoid Init(){\n    printf (\"\\n----------------------------------\");\n    printf (\"\\nDANH SACH QUAN LY SINH VIEN\");\n    printf (\"\\nNhap 1 de them ten moi\");\n    printf (\"\\nNhap 2 de sap xep\");\n    printf (\"\\nNhap 3 de in danh sach hien tai\");\n    printf (\"\\nNhap 4 de thoat\");\n    printf (\"\\n----------------------------------\");\n}\n\n/*\nThot chng trnh\n*/\nvoid Event4() {\n    system(\"cls\");\n    printf (\"\\nChac chan muon thoat chuong trinh ? (Nhap Y de ket thuc) \");\n    char ok;\n    fflush(stdin); scanf (\"%c\",&ok);\n    if (ok == 'Y' || ok == 'y') writeFile();\n    else {\n        fflush(stdin);\n        printf (\"Khong thoat chuong trinh\");\n    }\n}\n\n/*\nIn ra danh sch hin ti\n*/\nvoid Event3() {\n    system(\"cls\");\n    printf (\"Danh sach hien tai :\\n\\n\");\n    for (int i = 0; i <= count; i++){\n        printf (\"%s\",Arr[i]);\n    }\n}\n\n/*\nSp xp danh sch hin ti bng phng php sp xp chn\n*/\nvoid Event2() {\n    system(\"cls\");\n    char *min;\n    int res;\n    for (int i = 0; i <= count-1; i++) {\n        min = Arr[i]; res = i;\n        for (int j = i+1; j <= count; j++){\n           if (strcmp(min+getNamePosition(min), Arr[j]+getNamePosition(Arr[j])) == 0) {\n                if (strcmp(min,Arr[j]) > 0) {\n                    res = j;\n                    min = Arr[j];\n                }\n           } else\n           if (strcmp(min+getNamePosition(min), Arr[j]+getNamePosition(Arr[j])) > 0) {\n                res = j;\n                min = Arr[j];\n           }\n        }\n\n        min = Arr[i];\n        Arr[i] = Arr[res];\n        Arr[res] = min;\n    }\n    printf(\"Danh sach da duoc sap xep\");\n}\n\n/*\nNhp ln lt cc tn vo, nu gp tn l \"000\" hoc  1000 tn th dng li\nTrong hm c thao tc chnh sa cc tn nhp vo, tn nhp so c lu trong mng line, sau khi sa lu trong oLine\n*/\nvoid Event1() {\n    system(\"cls\");\n    while (1) {\n        printf(\"Nhap ten thu %d (Nhap \\\"000\\\" de dung lai) : \",count+2);\n        fflush(stdin); gets(line);\n        if (strcmp(line,\"000\") == 0 || count+1 == 1000) return;\n        if (count+1 >= maxArr) resizeArr();\n        editLine(line);\n\n        // Cp pht b nh cho Arr[count], nu khng  b nh th ghi file v thot chng trnh\n        Arr[count+1] = (char *) malloc(strlen(oLine)*sizeof(char));\n        if (Arr[count+1] == NULL) {\n            printf (\"Khong du bo nho de cap phat\");\n            writeFile();\n        }\n        count ++;\n\n        // Tn cui cng khng c k t \\n ng cui, dn n khng xung dng khi sp xp, ta thm k t \\n vo cui tn\n        strcat(oLine,\"\\n\");\n        strcpy(Arr[count],oLine);\n    }\n}\n\n/*\nS dng  cp pht li vng nh ln hn cho mng Arr\nCopy mng c ra mng mi c  rng ln hn\nNu mng mi khng  b nh  cp pht th ghi vo file, xa mng ri thot chng trnh\n*/\nvoid resizeArr (){\n    maxArr += 20;\n    char **newArr = (char**) malloc(maxArr*sizeof(char*));\n\n    // Kim tra xem cn b nh khng, nu khng cn th ghi vo file, xa mng Arr ri thot chng trnh\n    if (newArr == NULL) {\n        printf (\"\\nKhong du bo nho de cap phat\");\n        writeFile();\n    }\n\n    for (int i = 0; i <= maxArr/2; i++) newArr[i] = Arr[i];\n    free (Arr);\n    Arr = newArr;\n}\n\n/*\nLy ring tn ca mi xu\n*/\nint getNamePosition(char* S){\n    int i;\n    for (i = strlen(S)-1; i >= 0; i--){\n        if (S[i] == ' ') break;\n    }\n    return i+1;\n}\n\n/*\nChnh sa cc tn nhp vo :\n    Khng c bt u bng du cch\n    Khng c kt thc bng du cch\n    Khng c 2 du cch lin nhau trong tn\n*/\nvoid editLine(){\n    int i = 0, j = 0;\n    while (i <= strlen(line)) {\n        if (line[i] != ' ') {\n            oLine[j] = line[i];\n            i++;\n            j++;\n        }\n        if (line[i] == ' '){\n            if (j == 0) i++; else\n            if (line[i+1] == ' ') i++; else\n            if (line[i+1] == '\\0') i++; else\n            {\n                oLine[j] = line[i];\n                i++;\n                j++;\n            }\n        }\n    }\n}",
 "title": ""
}