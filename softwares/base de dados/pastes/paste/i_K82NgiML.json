{
 "espireDate": "N",
 "format": "text",
 "jSonReasons": [
  "kw_target",
  "lg_en"
 ],
 "key": "K82NgiML",
 "pasteDate": "Feb 24, 2018, 6:47:24 PM",
 "relevancy": 0.0,
 "relevant": false,
 "text": "    ;==================================\n    ; Script Name: Autoloot with specific item looting capabilities\n    ; Author: Patriot, Orngrimm\n    ; Version: 1.0\n    ; Client Tested with: 6.0.14.2\n    ; EUO version tested with: 1.5 B 158\n    ; Shard OSI / FS: both\n    ; Revision Date: 15.6.2010\n    ; Public Release: 9.6.2010\n    ; Global Variables Used: none\n    ; Purpose: opens and loots defined itemtypes.\n    ; Some types (Armor, Weaps, Jewelry) is only looted it they match one property-string of a defined selection.\n    ;==================================\n\n\n    ;=========== SETUP ================\n    set %property_looting_first #true\n\n    set %lootprop1 Wizards , #SPC , Strong , #SPC , Arm\n    set %lootprop2 spell , #SPC , channeling , #SPC , deed\n    set %lootprop3 Black , #SPC , Lotus , #SPC , Hood\n    set %lootprop4 A , #SPC , Runic , #SPC , Hammer\n    set %lootprop5 Rough , #SPC , Stone\n    set %lootprop6 stormgrips\n    set %number_of_markers 6\n\n    set %jewel _OWI\n    set %gold _POF_OWI_IIE_NVI_WRO_MPF_XDI_LYD_MDP_AZF_SDJ_BFF_CFF_IFF_HFF_KEJ\n    set %weapon _fuo_atf_npo_jph_tsf_nmh_vrh_jtf_soh_bph\n    +_lsf_bsf_nsf_zrf_rmh_lph_uoh_hsf_zto_buo_xth_opo_cuo\n    +_xrh_guo_mtf_rrh_vth_ysf_buh_auo_trh_zth_woh_usf_lmh\n    +_qpo_ppo ; Added POF for normal gp's\n    set %armor _gsh_osh_fik_gik_cik_nik_aik_mik_hlk_clk\n    +_czh_jwi_gzh_ewi_bwi_jjn_vvi_wvi_xvi_yvi_iwi_hwi_kwi\n    +_xvl_vjn_fci_jkh_njl_kkh_hkh_vkh_qkh_alh_xkh_ykh_mlh\n    +_llh_qsk_ysk_atk_usk_osk_ssk_yph_vph_bqh_cqh_pph\n    set %bag _ckf_lkf_zjf\n    set %gems _uvf_vuf_gvf_evf_hvf_ovf_fvf_bvf_rvf_ZVF_NVF ; Added ZVF for turmaline, NVF for saphire\n    set %regs _KUF_JUF_KZF_JZF_MZF_WZF_RZF_SZF_IUF_DUF_TZF_UZF_YZF\n    ;=========== END SETUP ============\n\n    ;=========== CONSTANTS ============\n    ;=========== END CONSTANTS ========\n\n    ;=========== Preparation =============\n    if sys notin #opts\n            {\n            display ok enable system messages and hit play\n            halt\n            }\n    if dmc notin #opts\n            {\n            display ok enable don't move cursor and hit play\n            halt\n            }\n    menu Clear\n    menu Window Title Corpse looter\n    menu Window Color maroon\n    menu Window Size 193 189\n    menu Font Transparent #true\n    menu Font Align Right\n    menu Shape EUOShape1 -4 4 93 183 3 2 1 Yellow 2 White\n    menu Font Name MS Sans Serif\n    menu Font Size 10\n    menu Font Style\n    menu Font Color Yellow\n    menu Font Transparent #false\n    menu Font Align Left\n    menu Font BGColor Maroon\n    menu Text EUOLabel1 4 8 What to Loot:\n    menu Font Size 8\n    menu Font Color Green\n    menu Text EUOLabel2 92 104 Current Weight\n    menu Font Color Background\n    menu Text EUOLabel3 92 132 % of Max Weight\n    menu Font Color WindowText\n    menu Text weight 104 120 EUOLabel4\n    menu Text per 104 144 EUOLabel5\n    menu Check gold 4 28 77 25 #false Gold\n    menu Check weapons 4 52 77 25 #false Weapons\n    menu Check armor 4 72 77 25 #false Armor\n    menu Check jewelery 4 100 77 25 #false Jewelery\n    menu Check bags 4 122 77 25 #false Bags\n    menu Check gems 4 142 77 25 #false Gems\n    menu Check regs 4 161 77 25 #false Regs\n    menu Font BGColor Red\n    menu Button cursor 92 0 103 25 Set Loot Location\n    menu Button min 92 24 103 25 Min. Update Range\n    menu Button norm 92 48 103 25 norm Update Range\n    menu Button pause 92 72 103 25 Pause\n    menu Show 421 270 halt\n    set #menubutton closed\n    ignoreitem reset\n    ;=========== End Preparation =========\n\n    ;=========== World-setup =============\n    gosub cursor\n    set %lootbagID #result\n    ;=========== End World-setup =========\n\n\n    ;=========== Maincode =============\n    while #true\n            {\n            set %loot_all\n            set %loot_always\n            set %loot_prop\n\n            menu get regs\n            if #menures = -1\n                    set %loot_always %loot_always , %regs\n            menu get gems\n            if #menures = -1\n                    set %loot_always %loot_always , %gems\n            menu get gold\n            if #menures = -1\n                    set %loot_always %loot_always , %gold\n            menu get weapons\n            if #menures = -1\n                    set %loot_prop %loot_prop , %weapon\n            menu get armor\n            if #menures = -1\n                    set %loot_prop %loot_prop , %armor\n            menu get jewelery\n            if #menures = -1\n                    set %loot_prop %loot_prop , %jewel\n            menu get bags\n            if #menures = -1\n                    set %loot_always %loot_always , %bag\n            if #menubutton = min\n                    {\n                    event macro 42 0\n                    set #menubutton closed\n                    }\n            if #menubutton = norm\n                    {\n                    event macro 43 0\n                    set #menubutton closed\n                    }\n            if #menubutton = pause\n                    {\n                    set #menubutton closed\n                    gosub pause\n                    }\n            if #charghost = yes\n                    gosub pause\n            if #menubutton = cursor\n                    gosub cursor\n            if #weight <> %weight\n                    {\n                    set %weight #weight\n                    menu delete weight\n                    menu Text weight 104 120 #weight\n                    set %perc #weight * 100 / #maxweight\n                    menu delete per\n                    menu Text per 104 144 %perc\n                    }\n            set %loot_all %loot_always , %loot_prop\n            finditem YFM G_1\n            if #findkind = -1\n                    continue ; Start over with a new iteration of the mainloop\n\n\n            set %body #findid\n            set #lobjectid #findid\n            nextCPos 10 10\n\n            ; Implemented a better setting of %bod\n\n            event macro 17 0\n            repeat\n                    {\n                    wait 1\n                    }\n            until #CONTNAME = container_gump && #CONTSIZE = 144_212\n            set %bod #ContID\n\n            while #true ; loot-loop\n                    {\n                    finditem %loot_all C_ , %bod\n                    if #findCNT = 0\n                            {\n                            event SysMessage finished Corpse.\n                            ignoreitem %body\n                            wait 15\n                            }\n\n                    if %property_looting_first\n                            {\n                            gosub loot_prop %loot_prop %bod %number_of_markers %lootbagid\n                            gosub loot_always %loot_always %bod %lootbagid\n                            Break ; Looting finished. Break the loot-loop\n                            }\n                    else\n                            {\n                            gosub loot_always %loot_always %bod %lootbagid\n                            gosub loot_prop %loot_prop %bod %number_of_markers %lootbagid\n                            Break ; Looting finished. Break the loot-loop\n                            }\n                    } ; end loot-loop\n            } ; end mainloop\n    ;=========== End Maincode =========\n\n\n    ;=========== SUBs =================\n    ; -------------------------\n    ; Sub name: cursor\n    ; Autor: Patriot, Orngrimm\n    ; Version: 1.0\n    ; Purpose: Lets the User target a item and returns this ID.\n    ; Params:       none\n    ; Outputs:      #result         ID of targetet item\n    ; -------------------------\n    sub cursor\n    set #menubutton closed\n    set #LTargetID NULL\n    set #TargCurs 1\n    event SysMessage Please click the lootbag.\n    menu Window Color blue\n    repeat\n            {\n            wait 1\n            }\n    until #LTargetID <> NULL\n    menu Window Color Maroon\n    return #LtargetID\n\n\n\n    ; -------------------------\n    ; Sub name: pause\n    ; Autor: Patriot\n    ; Version: 1.0\n    ; Purpose: Pauses the script until the unpause-button is pressed.\n    ; Params:       none\n    ; Outputs:      none\n    ; -------------------------\n    sub pause\n    menu Button pause 92 72 103 25 Resume\n    while #menubutton <> pause\n            {\n            wait 1\n            }\n    menu Button pause 92 72 103 25 Pause\n    set #menubutton closed\n    return\n\n\n    ; -------------------------\n    ; Sub name: loot_prop\n    ; Autor: Orngrimm\n    ; Version: 1.0\n    ; Purpose: Loots items with a specific type. But it loots them only if they meet a property-string-requirement\n    ; Params:       1       req     Lootlist\n    ;               2       req     Container-ID to loot from\n    ;               3       req     Ammount of markers %lootprop[#]\n    ;               4       req     Container-ID to store the loot\n    ; Outputs:      none\n    ; -------------------------\n    sub loot_prop\n    if %0 < 4\n            {\n            display OK Incorrect ammount of atributes passed to the sub. Script pauses for debug.\n            pause\n            return\n            }\n\n    ; Create a new namesapce to have vars at our disposal which\n    ; doesnt clutter the variable-space.\n    nameSpace Push\n    nameSpace Local #sysTime , #random\n    ; Here we check for props and loot only those who meet the props\n    Finditem %1 C_ , %2\n    if #FindCNT > 0 ; Check only if we found anything\n            {\n            for #FindIndex #FindCNT 1 ; check all found items\n                    {\n                    event property #findID\n                    set !looted #false\n                    for !cnt_o 1 %3 ; check all markers\n                            {\n                            set !temp_o lootprop , !cnt_o\n                            set !temp_o % . !temp_o\n                            if !temp_o in #Property ; Here was a_o missing\n                                    {\n                                    exevent drag #FindID #Findstack\n                                    exevent dropc %4\n                                    wait 15\n                                    set !looted #true\n                                    break ; If we looted it, there is no need to check for the other props.\n                                    }\n                            }\n                    ; Here we checked one item for all propertys. Ignore it if not interesting for looting\n                    if !looted = #false\n                            ignoreitem #FindID nonloot\n                    }\n            }\n    nameSpace Clear\n    nameSpace Pop\n    return\n\n\n    ; -------------------------\n    ; Sub name: loot_always\n    ; Autor: Orngrimm\n    ; Version: 1.0\n    ; Purpose: It loots all defined from the defined container to the defined target\n    ; Params:       1       req     Lootlist\n    ;               2       req     Container-ID to loot from\n    ;               3       req     Container-ID to store the loot\n    ; Outputs:      none\n    ; -------------------------\n    sub loot_always\n    if %0 < 3\n            {\n            display OK Incorrect ammount of atributes passed to the sub. Script pauses for debug.\n            pause\n            return\n            }\n    ; Here we check for props and loot only those who meet the props\n    Finditem %1 C_ , %2\n    if #FindCNT = 0\n            return\n    for #Findindex #FindCNT 1\n            {\n            exevent drag #FindID #Findstack\n            exevent dropc %3\n            wait 15\n            }\n    return\n    ;=========== End SUBs =============",
 "title": ""
}