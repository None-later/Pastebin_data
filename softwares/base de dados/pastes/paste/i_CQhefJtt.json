{
 "espireDate": "N",
 "format": "text",
 "jSonReasons": [
  "re_sql",
  "lg_pt"
 ],
 "key": "CQhefJtt",
 "pasteDate": "Feb 28, 2018, 10:03:13 AM",
 "relevancy": -1.0,
 "relevant": false,
 "text": "-- Pergunta a)\n\n-- Colunas Insuficientes\n\n-- Pergunta b)\n\nSELECT Partido, SUM(Mandatos) as TotalMandatos\nFROM Listas\nGROUP By Partido\nORDER BY TotalMandatos DESC\n;\n\n-- Pergunta c)\n\nSELECT v.PARTIDO, d.NOME, SUM(v.votos) as TotalVotos\nFROM Votacoes v\nJOIN Freguesias f ON v.FREGUESIA = f.CODIGO\nJOIN Concelhos c ON f.CONCELHO = c.CODIGO\nJOIN Distritos d ON c.DISTRITO = d.CODIGO\nGROUP BY v.PARTIDO, d.NOME, d.CODIGO\nORDER BY TotalVotos\n;\n\n-- Pergunta d)\n\nSELECT pvotos.Partido, dmax.Distrito, dmax.MaxVotosDist --, TotalVotos\nFROM\n(\nSELECT Distrito, MaxVotosDist\nFROM\n(\nSELECT Distrito, MAX(TOTALVOTOS) as MaxVotosDist, SUM(TOTALVOTOS) as TotalVotosDist\nFROM\n(\nSELECT v.PARTIDO as Partido, d.NOME as Distrito, SUM(v.votos) as TotalVotos\nFROM Votacoes v\nJOIN Freguesias f ON v.FREGUESIA = f.CODIGO\nJOIN Concelhos c ON f.CONCELHO = c.CODIGO\nJOIN Distritos d ON c.DISTRITO = d.CODIGO\nGROUP BY v.PARTIDO, d.NOME, d.CODIGO\nORDER BY PARTIDO\n)\nGROUP BY Distrito\n)\nWHERE MAXVOTOSDIST > (TOTALVOTOSDIST - MAXVOTOSDIST)\n) dmax\nJOIN\n(\nSELECT v.PARTIDO as Partido, d.NOME as Distrito, SUM(v.votos) as TotalVotos\nFROM Votacoes v\nJOIN Freguesias f ON v.FREGUESIA = f.CODIGO\nJOIN Concelhos c ON f.CONCELHO = c.CODIGO\nJOIN Distritos d ON c.DISTRITO = d.CODIGO\nGROUP BY v.PARTIDO, d.NOME, d.CODIGO\nORDER BY PARTIDO\n) pvotos\nON dmax.Distrito = pvotos.Distrito AND dmax.MaxVotosDist = pvotos.TotalVotos\n;-- Pergunta a)\n\n-- Colunas Insuficientes\n\n-- Pergunta b)\n\nSELECT Partido, SUM(Mandatos) as TotalMandatos\nFROM Listas\nGROUP By Partido\nORDER BY TotalMandatos DESC\n;\n\n-- Pergunta c)\n\nSELECT v.PARTIDO, d.NOME, SUM(v.votos) as TotalVotos\nFROM Votacoes v\nJOIN Freguesias f ON v.FREGUESIA = f.CODIGO\nJOIN Concelhos c ON f.CONCELHO = c.CODIGO\nJOIN Distritos d ON c.DISTRITO = d.CODIGO\nGROUP BY v.PARTIDO, d.NOME, d.CODIGO\nORDER BY TotalVotos\n;\n\n-- Pergunta d)\n\nSELECT pvotos.Partido, dmax.Distrito, dmax.MaxVotosDist --, TotalVotos\nFROM\n(\nSELECT Distrito, MaxVotosDist\nFROM\n(\nSELECT Distrito, MAX(TOTALVOTOS) as MaxVotosDist, SUM(TOTALVOTOS) as TotalVotosDist\nFROM\n(\nSELECT v.PARTIDO as Partido, d.NOME as Distrito, SUM(v.votos) as TotalVotos\nFROM Votacoes v\nJOIN Freguesias f ON v.FREGUESIA = f.CODIGO\nJOIN Concelhos c ON f.CONCELHO = c.CODIGO\nJOIN Distritos d ON c.DISTRITO = d.CODIGO\nGROUP BY v.PARTIDO, d.NOME, d.CODIGO\nORDER BY PARTIDO\n)\nGROUP BY Distrito\n)\nWHERE MAXVOTOSDIST > (TOTALVOTOSDIST - MAXVOTOSDIST)\n) dmax\nJOIN\n(\nSELECT v.PARTIDO as Partido, d.NOME as Distrito, SUM(v.votos) as TotalVotos\nFROM Votacoes v\nJOIN Freguesias f ON v.FREGUESIA = f.CODIGO\nJOIN Concelhos c ON f.CONCELHO = c.CODIGO\nJOIN Distritos d ON c.DISTRITO = d.CODIGO\nGROUP BY v.PARTIDO, d.NOME, d.CODIGO\nORDER BY PARTIDO\n) pvotos\nON dmax.Distrito = pvotos.Distrito AND dmax.MaxVotosDist = pvotos.TotalVotos\n;",
 "title": ""
}