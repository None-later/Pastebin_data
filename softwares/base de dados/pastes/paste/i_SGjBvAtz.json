{
 "espireDate": "N",
 "format": "text",
 "jSonReasons": [
  "lg_en",
  "re_ast1"
 ],
 "key": "SGjBvAtz",
 "pasteDate": "Feb 28, 2018, 3:25:01 AM",
 "relevancy": 1.0,
 "relevant": false,
 "text": "{{block type='core/template' area='frontend' template='email/external/customer.phtml'}}\n\t\n$fieldsName = Mage::getSingleton('core/session')->getFields();\nMage::getSingleton('core/session')->unsFields();\n\n$message = Mage::getSingleton('core/session')->getMessage();\nMage::getSingleton('core/session')->unsMessage();\n$emailTemplateData = Mage::getSingleton('core/session')->getEmailTemplateData();\nMage::getSingleton('core/session')->unsEmailTemplateData();\n?>\n<p style=\"padding: 5px;\"><?php echo $message; ?></p>\n<?php if ($emailTemplateData) : ?>\n    <table style=\"width:75%; padding: 5px;\">\n        <tr style=\"padding: 5px;\">\n            <td> <strong><?php echo \"Field\"; ?></strong></td>\n            <td> <strong><?php echo \"Data\"; ?></strong></td>\n        </tr>\n        <?php foreach ($emailTemplateData as $key => $value): ?>\n\n            <tr>\n                <td> <?php echo $fieldsName[$key] . \":\"; ?></td>\n                <td> <?php echo $value; ?></td>\n            </tr>\n\n        <?php endforeach; ?>\n\n    </table>\n\n<?php endif; ?>\n\t\npublic function sendEmail($subject, $fieldsName, $message, $emailTemplateData) {\n        //Want to send these not this way\n        Mage::getSingleton('core/session')->setFields($fieldsName);\n        Mage::getSingleton('core/session')->setMessage($message);\n        Mage::getSingleton('core/session')->setEmailTemplateData($emailTemplateData);\n\n        $emailTemplateVariables = array();\n        $emailTemplateCode = \"External Customer Creation\"; //Email Template Code\n        $emailTemplate = Mage::getModel('core/email_template')->loadByCode($emailTemplateCode);\n        $emailSubject = $subject; //Email Subject\n        $emailTemplateVariables['templateMessage'] = \"\"; //Variables for Confirmation Mail. \n\n        $senderName = Mage::getStoreConfig('trans_email/ident_general/name'); //Getting the Store E-Mail Sender Name.\n        $senderEmail = Mage::getStoreConfig('trans_email/ident_general/email'); //Getting the Store General E-Mail.\n        //Appending the Custom Variables to Template.\n\n        $processedTemplate = $emailTemplate->getProcessedTemplate($emailTemplateVariables);\n\n        //Sending email to listed id under \n        //\"Admin >> System >> Configuration >> Customer >> Customer Configuration >> External Source Customer Creation >> Confirmation email recipients\"\n        $emailIds = Mage::getStoreConfig('customer/external_source_customer/confirmation_email_to');\n        $toEmailList = explode(\",\", $emailIds);\n\n        foreach ($toEmailList as $toEmail) {\n\n            $mail = Mage::getModel('core/email')\n                    ->setToName($toName)\n                    ->setToEmail($toEmail)\n                    ->setBody($processedTemplate)\n                    ->setSubject($emailSubject)\n                    ->setFromEmail($senderEmail)\n                    ->setFromName($senderName)\n                    ->setType('html');\n\n            try {\n                $mail->send();\n            } catch (Exception $e) {\n                Mage::logException($e);\n            }\n        }\n    }\n\t\n<style>\nul {\n    margin-left: 0;\n    padding-left: 14px;\n}\n</style>\n\n<body style=\"background:#F6F6F6; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; margin:0; padding:0;\">\n<div style=\"background:#F6F6F6; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:12px; margin:0; padding:0;\">\n<table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\">\n<tr>\n    <td align=\"center\" valign=\"top\" style=\"padding:20px 0 20px 0\">\n        <table bgcolor=\"#FFFFFF\" cellspacing=\"0\" cellpadding=\"10\" border=\"0\" width=\"650\" style=\"border:1px solid #E0E0E0;font-size:12px;\">\n            <!-- [ header starts here] -->\n            <tr>\n                <td colspan='2' valign=\"top\"><a href=\"{{store url=\"\"}}\"><img src=\"{{skin url=\"images/abc-logo-225x83.png\" _area=\"frontend\" _package=\"default\" _theme=\"abc\"}}\" alt=\"{{var logo_alt}}\" style=\"margin-bottom:10px;\" border=\"0\"/></a></td>\n            </tr>\n            <!-- [ middle starts here] -->\n            <tr>\n                <td valign=\"top\" colspan='2'>\n                    <p style=\"line-height:16px; margin:0;\">\n                     {{block type='core/template' area='frontend' mydata=$fieldsName template='email/external/customer.phtml'}}\n                    </p>\n                </td>\n            </tr>\n            <tr>\n                <td colspan='2' bgcolor=\"#EAEAEA\" align=\"center\" style=\"background:#EAEAEA; text-align:center;\"><center><p style=\"font-size:12px; margin:0;\">Thank you, <strong>abc Team</strong></p></center></td>\n            </tr>\n        </table>\n    </td>\n</tr>\n</table>\n</div>\n</body>",
 "title": ""
}