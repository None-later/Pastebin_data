{
 "espireDate": "N",
 "format": "lua",
 "jSonReasons": [
  "re_url",
  "lg_en",
  "re_ast1"
 ],
 "key": "NvRC8P7t",
 "pasteDate": "Feb 8, 2018, 11:51:13 PM",
 "relevancy": 0.0,
 "relevant": false,
 "text": "local Hell = false\nlocal Video = nil\nlocal Noise = nil\nlocal Scream = nil\nlocal cache = { }\ntimercache = { }\nsoundcache = { }\nmodelcache = { }\n\nlocal debrisrand = {\n  'models/props_debris/concrete_chunk02b.mdl', \n  'models/props_debris/concrete_chunk02a.mdl', \n  'models/props_debris/broken_pile001a.mdl', \n  'models/props_debris/concrete_chunk01a.mdl'\n}\n\nlocal mdl = {\n  \"models/Gibs/HGIBS.mdl\",\n  \"models/Gibs/HGIBS_rib.mdl\",\n  \"models/Gibs/HGIBS_scapula.mdl\",\n  \"models/Gibs/HGIBS_spine.mdl\",\n  \"models/props_c17/doll01.mdl\",\n  \"models/props_junk/sawblade001a.mdl\",\n  \"models/props_debris/concrete_chunk03a.mdl\",\n  \"models/props_debris/concrete_chunk04a.mdl\"\n}\n\nlocal CreatePhysModel = function(mdl)\n  local ent = ents.CreateClientProp()\n  ent:SetModel(mdl)\n  ent:PhysicsInit(SOLID_VPHYSICS)\n  ent:SetMoveType(MOVETYPE_VPHYSICS)\n  ent:SetSolid(SOLID_VPHYSICS)\n\n  table.insert(modelcache, ent)\n\n  return ent\nend\n\nlocal CreateModel = function(mdl, isragdoll)\n  local ent\n\n  if isragdoll then\n    ent = ClientsideRagdoll(mdl)\n  else\n    ent = ClientsideModel(mdl, RENDERGROUP_OTHER)\n  end\n  \n  table.insert(modelcache, ent)\n  \n  return ent\nend\n\nlocal AddSound = function(name)\n  local snd = CreateSound(LocalPlayer(), name)\n  \n  table.insert(soundcache, snd)\n  \n  return snd\nend\n\nlocal NewHookAdd = function(str, name, func)\n  --name = \"dronesrewrite_hell_hooks\" .. name\n  hook.Add(str, name, func)\n  \n  table.insert(cache, {\n    str = str,\n    name = name\n  })\nend\n\nlocal NewTimerSimple = function(time, func)\n  local name = \"dronesrewrite_hell_timers\" .. table.Count(timercache)\n  timer.Create(name, time, 1, func)\n  \n  table.insert(timercache, {\n    name = name\n  })\nend\n\nlocal StopTimers = function() for k, v in pairs(timercache) do timer.Destroy(v.name) end end\nlocal RemoveHooks = function() for k, v in pairs(cache) do hook.Remove(v.str, v.name) end end\nlocal StopSounds = function() for k, v in pairs(soundcache) do if v then v:Stop() end end end\nlocal RemoveModels = function() for k, v in pairs(modelcache) do SafeRemoveEntity(v) end end\n\nlocal function End()\n  local snd = CreateSound(LocalPlayer(), \"ambient/gas/steam2.wav\")\n  snd:Play()\n  snd:ChangePitch(250, 0)\n      \n  hook.Add(\"RenderScreenspaceEffects\", \"dronesrewrite_hell_renderend\", function()\n    local eff_tab = {\n      [\"$pp_colour_addr\"] = 0,\n      [\"$pp_colour_addg\"] = 0,\n      [\"$pp_colour_addb\"] = 0,\n      [\"$pp_colour_brightness\"] = -1,\n      [\"$pp_colour_contrast\"] = 1,\n      [\"$pp_colour_colour\"] = 0,\n      [\"$pp_colour_mulr\"] = 0,\n      [\"$pp_colour_mulg\"] = 0,\n      [\"$pp_colour_mulb\"] = 0\n    }\n            \n    DrawColorModify(eff_tab)\n    DrawMaterialOverlay(\"effects/tvscreen_noise002a\", 0)\n  end)\n\n  surface.PlaySound(\"hl1/ambience/port_suckin1.wav\")\n  surface.PlaySound(\"hl1/ambience/particle_suck2.wav\")\n\n  timer.Simple(4, function()\n    snd:Stop()\n    snd = nil\n    hook.Remove(\"RenderScreenspaceEffects\", \"dronesrewrite_hell_renderend\")\n\n    local Const = 1\n    hook.Add(\"RenderScreenspaceEffects\", \"dronesrewrite_hell_renderend2\", function()\n      Const = Lerp(0.005, Const, 0)\n      if Const <= 0.05 then hook.Remove(\"RenderScreenspaceEffects\", \"dronesrewrite_hell_renderend2\") end\n\n      local eff_tab = {\n        [\"$pp_colour_addr\"] = Const * 0.1,\n        [\"$pp_colour_addg\"] = Const * 0.1,\n        [\"$pp_colour_addb\"] = 0,\n        [\"$pp_colour_brightness\"] = -Const,\n        [\"$pp_colour_contrast\"] = 1 + Const * 0.9,\n        [\"$pp_colour_colour\"] = 1,\n        [\"$pp_colour_mulr\"] = Const * 5,\n        [\"$pp_colour_mulg\"] = Const,\n        [\"$pp_colour_mulb\"] = 0\n      }\n      \n      DrawColorModify(eff_tab)\n      \n      DrawBloom(Const * 1, Const, Const, Const, Const, Const, Const, Const, Const)\n      DrawSharpen(Const * 0.7, Const * 4)\n      DrawMotionBlur(Const * 0.3, Const, Const * 0.01)\n\n      DrawToyTown(Const * 8, ScrH())\n    end)\n\n    local snd = CreateSound(LocalPlayer(), \"drones/hell/screamshorror.wav\")\n    snd:Play()\n    snd:ChangePitch(110, 0)\n\n    timer.Simple(14, function()\n      snd:ChangeVolume(0, 5)\n    end)\n\n    util.ScreenShake(LocalPlayer():GetPos(), 3, 55, 5, 1000)\n    surface.PlaySound(\"ambient/machines/machine1_hit2.wav\")\n  end)\n\n  RemoveHooks()\n  StopTimers()\n  StopSounds()\n  RemoveModels()\n    \n  timer.Destroy(\"dronesrewrite_loopscreamer\")\n      \n  if IsValid(Noise) then Noise:Stop() end\n  if IsValid(Scream) then Scream:Stop() end\n\n  LocalPlayer():SetNoDraw(false)\n  LocalPlayer():DrawViewModel(true)\n      \n  Hell = false\nend\n\nlocal function EnableHell()\n  local Models = { }\n  local Scrap = { }\n  \n  local Const = 0\n\n  local function AddRender()\n    NewHookAdd(\"RenderScreenspaceEffects\", \"dronesrewrite_hell_render\", function()\n      local eff_tab = {\n        [\"$pp_colour_addr\"] = Const * 0.1,\n        [\"$pp_colour_addg\"] = Const * 0.1,\n        [\"$pp_colour_addb\"] = 0,\n        [\"$pp_colour_brightness\"] = -Const,\n        [\"$pp_colour_contrast\"] = 1 + Const * 0.9,\n        [\"$pp_colour_colour\"] = 1,\n        [\"$pp_colour_mulr\"] = Const * 5,\n        [\"$pp_colour_mulg\"] = Const,\n        [\"$pp_colour_mulb\"] = 0\n      }\n      \n      DrawColorModify(eff_tab)\n      \n      DrawBloom(Const * 1, Const, Const, Const, Const, Const, Const, Const, Const)\n      DrawSharpen(Const * 0.7, Const * 4)\n      DrawMotionBlur(Const * 0.3, Const, Const * 0.01)\n    end)\n  end\n\n  local function MakeNoise(tiem)\n    local snd = AddSound(\"ambient/gas/steam2.wav\")\n    snd:Play()\n    snd:ChangePitch(250, 0)\n    /*\n    NewHookAdd(\"RenderScreenspaceEffects\", \"dronesrewrite_hell_render\", function()\n      local eff_tab = {\n        [\"$pp_colour_addr\"] = 0,\n        [\"$pp_colour_addg\"] = 0,\n        [\"$pp_colour_addb\"] = 0,\n        [\"$pp_colour_brightness\"] = -1,\n        [\"$pp_colour_contrast\"] = 1,\n        [\"$pp_colour_colour\"] = 0,\n        [\"$pp_colour_mulr\"] = 0,\n        [\"$pp_colour_mulg\"] = 0,\n        [\"$pp_colour_mulb\"] = 0\n      }\n              \n      DrawColorModify(eff_tab)\n      DrawMaterialOverlay(\"effects/tvscreen_noise002a\", 0)\n    end)\n      */\n    NewTimerSimple(tiem, function() snd:Stop() AddRender() end)\n  end\n\n  local function LastScene()\n    local staticPos\n    local newAng\n    local toChangeAng\n    local screamer\n      \n    NewHookAdd(\"ShouldDrawLocalPlayer\", \"dronesrewrite_hell_govno\", function() return false end)\n      \n    NewHookAdd(\"CalcView\", \"dronesrewrite_hell_lastScene\", function(ply, pos, ang, fov)\n      if not staticPos then staticPos = pos end\n      if not newAng then newAng = ang end\n      if not toChangeAng then toChangeAng = Angle(0, newAng.y + 180, 0) end\n\n      if not screamer then\n        local ang = newAng\n        ang.p = 0\n        \n        screamer = CreateModel(\"models/Zombie/Poison.mdl\")\n        screamer:SetPos(pos - Vector(0, 0, 60) - ang:Forward() * 50)\n        screamer:SetAngles(ang)\n        screamer:SetModelScale(1.2, 0)\n        screamer:Spawn()\n        screamer:SetSequence(2)\n\n        local dlight = DynamicLight(LocalPlayer():EntIndex())\n        if dlight then\n          dlight.pos = pos - ang:Forward() * 40\n          dlight.r = 255\n          dlight.g = 0\n          dlight.b = 0\n          dlight.brightness = 10\n          dlight.Decay = 300\n          dlight.Size = 2000\n          dlight.DieTime = CurTime() + 0.7\n        end\n      end\n\n      newAng = LerpAngle(0.25, newAng, toChangeAng + AngleRand() * 0.06)\n\n      local view = { }\n      view.origin = staticPos\n      view.angles = newAng\n      view.fov = fov\n      \n      return view\n    end)\n    \n    surface.PlaySound(\"vo/npc/male01/pain07.wav\")\n      \n    NewTimerSimple(0.3, function() surface.PlaySound(\"npc/stalker/go_alert2a.wav\") end)\n      \n    NewTimerSimple(3, function()\n      surface.PlaySound(\"hl1/ambience/particle_suck2.wav\")\n          \n      End()\n      if screamer then screamer:Remove() end\n          \n      local snd = AddSound(\"hl1/ambience/deadsignal2.wav\")\n      snd:Play()\n        \n      surface.PlaySound(\"beams/beamstart5.wav\")\n      /*\n      NewHookAdd(\"RenderScreenspaceEffects\", \"homoef\", function()\n        local eff_tab = {\n          [\"$pp_colour_addr\"] = 0,\n          [\"$pp_colour_addg\"] = 0,\n          [\"$pp_colour_addb\"] = 0,\n          [\"$pp_colour_brightness\"] = -1,\n          [\"$pp_colour_contrast\"] = 1,\n          [\"$pp_colour_colour\"] = 0,\n          [\"$pp_colour_mulr\"] = 0,\n          [\"$pp_colour_mulg\"] = 0,\n          [\"$pp_colour_mulb\"] = 0\n        }\n              \n        DrawColorModify(eff_tab)\n        DrawMaterialOverlay(\"effects/tvscreen_noise002a\", 0)\n      end)\n      */\n            \n      NewTimerSimple(10, function()\n        snd:Stop()\n                \n        End()\n      end)\n    end)\n  end\n\n  AddRender()\n\n  local function MakeCorpse()\n    sound.Play(\"npc/zombie/zombie_alert1.wav\", LocalPlayer():GetPos(), 90, math.random(40, 70))\n\n    local tr = util.TraceLine({\n      start = LocalPlayer():GetPos(),\n      endpos = LocalPlayer():GetPos() + vector_up * 5000,\n      filter = LocalPlayer()\n    })\n\n    local x = math.random(0, 360)\n    local tr = util.TraceLine({\n      start = tr.HitPos,\n      endpos = tr.HitPos + Vector(math.cos(x), math.sin(x), 0) * math.random(1000, 2000),\n      filter = LocalPlayer()\n    })\n\n    local tr = util.TraceLine({\n      start = tr.HitPos,\n      endpos = tr.HitPos - vector_up * 20000,\n      filter = LocalPlayer()\n    })\n\n    local pos = tr.HitPos - tr.HitNormal * 8\n\n    local mdl = CreateModel(\"models/Humans/Charple02.mdl\")\n    mdl:SetAngles(Angle(-70, math.random(0, 360), 0))\n    mdl:SetNoDraw(false)\n    mdl:DrawShadow(true)\n    mdl:SetPos(pos)\n  end\n\n  local function MakeGuys()\n    local tr = util.TraceLine({\n      start = LocalPlayer():GetPos(),\n      endpos = LocalPlayer():GetPos() + Vector(0, 0, 10000),\n      filter = LocalPlayer()\n    })\n\n    local x = math.random(0, 360)\n    local tr = util.TraceLine({\n      start = tr.HitPos + tr.HitNormal * 32,\n      endpos = tr.HitPos + Vector(math.cos(x), math.sin(x), 0) * math.random(1000, 2000),\n      filter = LocalPlayer()\n    })\n\n    local tr = util.TraceLine({\n      start = tr.HitPos + tr.HitNormal * 32,\n      endpos = tr.HitPos - vector_up * 20000,\n      filter = LocalPlayer()\n    })\n\n    local pos = tr.HitPos\n\n    --ParticleEffect(\"fire_test2\", pos, Angle(0, 0, 0))\n\n    NewTimerSimple(2.2, function()\n      sound.Play(\"vo/npc/male01/no02.wav\", LocalPlayer():GetPos(), 75, math.random(70, 90), 1)\n\n      local mdl = CreateModel(\"models/Humans/Group01/Male_Cheaple.mdl\")\n      mdl:SetModelScale(2, 0)\n      mdl:SetAngles(Angle(0, (LocalPlayer():GetPos() - tr.HitPos):Angle().y, 0))\n      mdl:SetPos(pos)\n      mdl:SetMaterial(\"models/flesh\")\n      mdl:SetColor(Color(255, 0, 0))\n      mdl:Spawn()\n      \n      NewTimerSimple(math.Rand(1, 3), function() mdl:Remove() end)\n    end)\n  end\n  \n  local function MakeCamera()\n    local moan = AddSound(\"ambient/voices/crying_loop1.wav\")\n    moan:Play()\n    moan:ChangePitch(math.random(50, 60), 0)\n\n    surface.PlaySound(\"npc/zombie/foot_slide\" .. math.random(1, 3) .. \".wav\")\n    surface.PlaySound(\"npc/barnacle/barnacle_tongue_pull\" .. math.random(1, 3) .. \".wav\")\n\n    NewHookAdd(\"HUDPaint\", \"dronesrewrite_drawshit\", function()\n      --surface.SetMaterial(Material(\"stuff/misc/room\"))\n      --surface.SetDrawColor(Color(255, 255, 255))\n\n      local movex = math.random(-600, 0)\n      local movey = math.random(-600, 0)\n      surface.DrawTexturedRect(movex, movey, ScrW() - movex, ScrH() - movey)\n    end)\n\n    NewTimerSimple(math.Rand(0.1, 0.2), function()\n      hook.Remove(\"HUDPaint\", \"dronesrewrite_drawshit\") \n      moan:Stop()\n    end)\n  end\n  \n  local crying\n  NewTimerSimple(3.5, function()\n    crying = AddSound(\"ambient/voices/crying_loop1.wav\")\n    crying:Play()\n    \n    for i = 1, 6 do\n      NewTimerSimple(math.Rand(1, 8), function()\n        util.ScreenShake(LocalPlayer():GetPos(), 30, 7, 4, 1000)\n        surface.PlaySound(\"physics/concrete/boulder_impact_hard\" .. math.random(1, 4) .. \".wav\")\n      end)\n    end\n  end)\n  \n  NewTimerSimple(7, function()\n    NewTimerSimple(5, function() MakeNoise(3) end)\n    \n    NewTimerSimple(6, function()\n      crying:Stop()\n      Const = 1.2 -- instant shit\n\n      for i = 1, 200 do\n        MakeCorpse()\n      end\n\n      local no_drawing = {\n        CHudHealth = true,\n        CHudBattery = true,\n        CHudCrosshair = true,\n        CHudAmmo = true,\n        CHudSecondaryAmmo = true,\n        NetGraph = true\n      }\n\n      NewHookAdd(\"HUDShouldDraw\", \"dronesrewrite_hell_nohuddraw\", function(name)\n        if no_drawing[name] then return false end\n      end)\n\n      NewHookAdd(\"PlayerBindPress\", \"dronesrewrite_hell_shitmenu\", function(ply, bind, p) \n        local tools = {\n          \"phys_swap\",\n          \"slot\",\n          \"invnext\",\n          \"invprev\",\n          \"lastinv\",\n          \"gmod_tool\",\n          \"gmod_toolmode\"\n        }\n\n        for k, v in pairs(tools) do if bind:find(v) then return true end end\n      end)\n\n      --for i = 1, 10 do\n        AddSound(\"drones/hell/666.wav\"):Play()\n      --end\n    \n      sound.PlayURL(\"https://drive.google.com/uc?export=download&id=0B-bmGdZLSKZFX0xMNnR1OU5iRE0\", \"mono\",function(sts)\n        if IsValid(sts) then Noise = sts end\n      end)\n      \n      sound.PlayURL(\"https://drive.google.com/uc?export=download&id=0B-bmGdZLSKZFRDVSX3Z6Nk5oNVk\", \"mono\",function(sts)\n        if IsValid(sts) then Scream = sts end\n      end)\n\n      --NewHookAdd(\"HUDShouldDraw\", \"nohud\", function() return false end)\n\n      --[[local ang = LocalPlayer():EyeAngles()\n      NewHookAdd(\"CalcView\", \"dronesrewrite_makeshitstatic\", function(ply, _pos, _ang, fov)\n        local view = { }\n        view.origin = _pos\n        view.angles = ang\n        view.fov = fov\n    \n          ang = Lerp(0.2, ang, _ang)\n        return view\n      end)]]\n\n      LocalPlayer():SetNoDraw(true)\n      LocalPlayer():DrawViewModel(false)\n\n      for i = 1, 300 do\n        local e = CreateModel(\"models/weapons/w_bugbait.mdl\")\n        e:SetModelScale(math.random(200, 300), 0)\n        e:SetAngles(Angle(90, 0, 0))\n        \n        local vec = VectorRand() * 12000\n        vec.z = math.abs(vec.z) / 3\n        e:SetPos(LocalPlayer():GetPos() + vec)\n        e:Spawn()\n\n        e.RotDir = math.random(-1, 1)\n        e.ZDist = math.Rand(1, 10)\n        e.ZSpeed = math.Rand(0.3, 1.1)\n        \n        Models[i] = e\n      end\n      \n      sound.Play(\"npc/stalker/go_alert2a.wav\", LocalPlayer():GetPos(), math.random(50, 120), math.random(30, 70), 1)\n      util.ScreenShake(LocalPlayer():GetPos(), 3, 55, 5, 1000)\n      timer.Create(\"dronesrewrite_loopscreamer\", 1.5, 0, function()\n        sound.Play(\"vo/ravenholm/madlaugh03.wav\", LocalPlayer():GetPos(), 100, math.random(60, 80), 1)\n        util.ScreenShake(LocalPlayer():GetPos(), 3, 55, 5, 1000)\n      end)\n      \n      NewTimerSimple(9, function()\n        local dlight = DynamicLight(LocalPlayer():EntIndex())\n        if dlight then\n          dlight.pos = Vector(-2224.216797, -2918.063721, 2354.03125)\n          dlight.r = 255\n          dlight.g = 0\n          dlight.b = 0\n          dlight.brightness = 16\n          dlight.Decay = 1000\n          dlight.Size = 2000\n          dlight.DieTime = CurTime() + 2\n        end\n\n        local pos = LocalPlayer():GetPos() + Vector(0, 0, 120)\n        local ang = Angle(0, LocalPlayer():GetAngles().y, 0)\n\n        local tr = util.TraceLine({\n          start = pos,\n          endpos = pos + ang:Forward() * 86,\n          filter = LocalPlayer()\n        })\n\n        local rag_pos = tr.HitPos + tr.HitNormal * 32 - Vector(0, 0, 100)\n\n        for i = 1, 16 do\n          sound.Play(\"npc/stalker/go_alert2a.wav\", LocalPlayer():GetPos(), 120, 80, 1)\n        end\n\n        local mdl = CreateModel(\"models/Humans/Charple01.mdl\")\n        mdl:SetModelScale(1.5, 0)\n        mdl:SetAngles(ang + Angle(0, 180, 0))\n        mdl:SetColor(Color(255, 0, 0))\n        mdl:SetPos(rag_pos)\n        mdl:Spawn()\n\n        --ParticleEffect(\"fire_test2\", rag_pos, Angle(0, 0, 0))\n\n        NewHookAdd(\"CalcView\", \"dronesrewrite_doshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = pos + VectorRand()\n          view.angles = ang\n          view.fov = fov + math.random(-80, -50)\n          \n          return view\n        end)\n        \n        NewTimerSimple(1, function() \n          MakeNoise(0.5)\n          mdl:Remove()\n          hook.Remove(\"CalcView\", \"dronesrewrite_doshit\") \n        end)\n      end)\n\n      NewTimerSimple(14, function()\n        NewHookAdd(\"CalcView\", \"dronesrewrite_makeshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = _pos + VectorRand() * 25\n          view.angles = _ang\n          view.fov = fov\n\n          return view\n        end)\n\n        NewTimerSimple(2, function() hook.Remove(\"CalcView\", \"dronesrewrite_makeshit\") end)\n      end)\n\n      NewTimerSimple(25, function()\n        NewHookAdd(\"CalcView\", \"dronesrewrite_makeshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = _pos + VectorRand() * 50\n          view.angles = _ang + AngleRand() * 0.08\n          view.fov = fov\n\n          return view\n        end)\n\n        NewTimerSimple(3, function() hook.Remove(\"CalcView\", \"dronesrewrite_makeshit\") end)\n      end)\n\n      NewTimerSimple(20, function()\n        for i = 1, 50 do\n          MakeNoise(0.5)\n          MakeGuys()\n        end\n\n        NewTimerSimple(4.6, function() MakeNoise(0.6) end)\n      end)\n\n      NewTimerSimple(30, function()\n        for i = 1, 20 do\n          surface.PlaySound(\"npc/barnacle/barnacle_die\" .. math.random(1, 2) .. \".wav\")\n        end\n      end)\n\n      NewTimerSimple(35, function()\n        --- AOOSIDJOAIDOSDIFJAS\n        for i = 1, 10 do\n          sound.Play(\"vo/ravenholm/madlaugh03.wav\", LocalPlayer():GetPos(), 100, math.random(30, 70), 1)\n        end\n      end)\n\n      NewTimerSimple(40, function()\n        NewHookAdd(\"CalcView\", \"dronesrewrite_makeshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = _pos\n          view.angles = Angle(_ang.p, _ang.y + CurTime() * 100, math.random(-5, 5))\n          view.fov = fov\n\n          return view\n        end)\n\n        NewTimerSimple(3, function() hook.Remove(\"CalcView\", \"dronesrewrite_makeshit\") end)\n      end)\n      \n      NewTimerSimple(48, function()\n        MakeNoise(0.5)\n        \n        NewHookAdd(\"CalcView\", \"dronesrewrite_doshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = _pos\n          view.angles = _ang\n          view.fov = fov + math.random(-30, -10)\n          \n          return view\n        end)\n        \n        NewTimerSimple(4, function() hook.Remove(\"CalcView\", \"dronesrewrite_doshit\") end)\n      end)\n      \n      NewTimerSimple(65, function()\n        MakeNoise(0.5)\n        \n        sound.Play(\"npc/fast_zombie/fz_frenzy1.wav\", Vector(-2957.615723, -1470.495605, -100.968750), 120, 75, 1)\n        \n        local dlight = DynamicLight(LocalPlayer():EntIndex())\n        if dlight then\n          dlight.pos = Vector(-3131.937988, -1468.487793, -120.96875)\n          dlight.r = 255\n          dlight.g = 0\n          dlight.b = 0\n          dlight.brightness = 10\n          dlight.Decay = 300\n          dlight.Size = 2000\n          dlight.DieTime = CurTime() + 0.6\n        end\n        \n        NewHookAdd(\"CalcView\", \"dronesrewrite_doshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = Vector(-2957.615723, -1470.495605, -100.968750) + VectorRand() * 12\n          view.angles = Angle(0, 179, 0)\n          view.fov = fov\n          \n          return view\n        end)\n        \n        local mdl = CreateModel(\"models/Zombie/Fast.mdl\")\n        mdl:SetModelScale(1.5, 0)\n        mdl:SetAngles(Angle(0, 0, 0))\n        mdl:SetMaterial(\"models/debug/debugwhite\")\n        mdl:SetColor(Color(255, 0, 0))\n        mdl:SetPos(Vector(-3131.937988, -1468.487793, -140.96875))\n        mdl:Spawn()\n        \n        NewTimerSimple(1, function()\n          MakeNoise(0.3)\n\n          --ParticleEffect(\"fire_test2\", Vector(-3131.937988, -1468.487793, -120.96875), Angle(0, 0, 0))\n\n          for i = 1, 18 do\n            sound.Play(\"npc/stalker/go_alert2a.wav\", LocalPlayer():GetPos(), 120, 80, 1)\n          end\n          \n          mdl:SetPos(Vector(-3031.937988, -1468.487793, -140.96875))\n          mdl:SetSequence(5)\n          \n          local dlight = DynamicLight(LocalPlayer():EntIndex())\n          if dlight then\n            dlight.pos = Vector(-3131.937988, -1468.487793, -120.96875)\n            dlight.r = 255\n            dlight.g = 0\n            dlight.b = 0\n            dlight.brightness = 16\n            dlight.Decay = 300\n            dlight.Size = 2000\n            dlight.DieTime = CurTime() + 0.7\n          end\n        end)\n        \n        NewTimerSimple(2, function() \n          MakeNoise(0.5)\n          mdl:Remove()\n          \n          hook.Remove(\"CalcView\", \"dronesrewrite_doshit\") \n        end)\n      end)\n      \n      NewTimerSimple(80, function()\n        local tr = util.TraceLine({\n          start = LocalPlayer():GetPos(),\n          endpos = LocalPlayer():GetPos() + Vector(0, 0, 10000),\n          filter = LocalPlayer()\n        })\n\n        local x = math.random(0, 360)\n        local tr = util.TraceLine({\n          start = tr.HitPos + tr.HitNormal * 32,\n          endpos = tr.HitPos + Vector(math.cos(x), math.sin(x), 0) * 1000,\n          filter = LocalPlayer()\n        })\n\n        local tr = util.TraceLine({\n          start = tr.HitPos + tr.HitNormal * 32,\n          endpos = tr.HitPos - vector_up * 20000,\n          filter = LocalPlayer()\n        })\n\n        local pos = tr.HitPos\n\n        sound.Play(\"vo/npc/vortigaunt/allwecanspare.wav\", pos, 120, 75, 1)\n        for i = 1, 8 do\n          sound.Play(\"npc/stalker/go_alert2a.wav\", LocalPlayer():GetPos(), math.random(50, 120), 80, 1)\n        end\n        \n        local dlight = DynamicLight(LocalPlayer():EntIndex())\n        if dlight then\n          dlight.pos = pos + Vector(0, 30, 32)\n          dlight.r = 255\n          dlight.g = 0\n          dlight.b = 0\n          dlight.brightness = 1\n          dlight.Decay = 1000\n          dlight.Size = 2500\n          dlight.DieTime = CurTime() + 2\n        end\n        \n        NewHookAdd(\"CalcView\", \"dronesrewrite_doshit\", function(ply, _pos, _ang, fov)\n          local view = { }\n          view.origin = pos + Vector(0, 100, 140) + VectorRand() * 4\n          view.angles = Angle(11, -90, 0)\n          view.fov = fov + math.random(-50, -30)\n          \n          return view\n        end)\n    \n        local mdl = CreateModel(\"models/Humans/Group01/Male_Cheaple.mdl\")\n        mdl:SetModelScale(2, 0)\n        mdl:SetAngles(Angle(0, 90, 0))\n        mdl:SetPos(tr.HitPos)\n          mdl:SetMaterial(\"models/flesh\")\n        mdl:SetColor(Color(255, 0, 0))\n        mdl:Spawn()\n        \n        NewTimerSimple(1.5, function() \n          MakeNoise(0.5)\n          for i = 1, 16 do MakeGuys() end\n          \n          mdl:Remove()\n          \n          hook.Remove(\"CalcView\", \"dronesrewrite_doshit\") \n        end)\n      end)\n      \n      NewTimerSimple(90, function()\n        for i = 1, 18 do \n          sound.Play(\"drones/nightvisionon.wav\", LocalPlayer():GetPos(), 100, math.random(18, 35), 1) \n        end\n        \n        LastScene()\n      end)\n    end)\n  end)\n  \n  \n  local emitter = ParticleEmitter(Vector(0, 0, 0))\n  \n  NewHookAdd(\"Think\", \"countgay\", function()\n    if Const < 1.2 then \n      Const = math.Approach(Const, 1, 0.0015)\n    else\n      for i = 1, math.random(1, 3) do\n        local newmdl = table.Random(mdl)\n        local e = CreateModel(newmdl)\n        local scale\n\n        if string.find(newmdl, \"HGIBS\") then\n          scale = 8\n        else\n          scale = math.Rand(1, 2)\n        end\n\n        e:SetModelScale(scale, 0)\n        e:SetAngles(VectorRand():Angle())\n        \n        local vec = VectorRand() * 2000\n        vec.z = vec.z / 2\n        vec = LocalPlayer():GetPos() + vec + Vector(0, 0, 420)\n              \n        e:SetPos(vec)\n        e:Spawn()\n        e.Speed = math.Rand(10, 35)\n\n        --ParticleEffectAttach(\"skull_trail\", PATTACH_ABSORIGIN_FOLLOW, e, 0)\n            \n        table.insert(Scrap, e)\n      end\n\n      if math.random(1, 3) == 1 then\n        local debris = CreatePhysModel(table.Random(debrisrand))\n        debris:SetPos(LocalPlayer():GetPos() + Vector(0, 0, 700))\n        debris:SetAngles(AngleRand())\n        debris:Spawn()\n        debris:SetModelScale(math.Rand(2, 3), 0)\n\n        local phys = debris:GetPhysicsObject()\n        if phys:IsValid() then\n          phys:Wake()       \n          phys:SetVelocity(VectorRand() * 400)\n          phys:AddAngleVelocity(VectorRand() * 100)\n        end\n      end\n\n      --for i = 1, 10 do\n        local tr = util.TraceLine({\n          start = LocalPlayer():GetPos(),\n          endpos = LocalPlayer():GetPos() + Vector(0, 0, 10000),\n          filter = LocalPlayer()\n        })\n\n        local x = math.random(0, 360)\n        local tr = util.TraceLine({\n          start = tr.HitPos + tr.HitNormal * 32,\n          endpos = tr.HitPos + Vector(math.cos(x), math.sin(x), 0) * math.random(100, 300),\n          filter = LocalPlayer()\n        })\n\n        local tr = util.TraceLine({\n          start = tr.HitPos + tr.HitNormal * 32,\n          endpos = tr.HitPos - vector_up * 10000,\n          filter = LocalPlayer()\n        })\n\n        local pos = tr.HitPos\n\n        --ParticleEffect(\"fire_test\", pos, Angle(0, 0, 0))\n      --end\n      \n      if math.random(1, 50) == 1 then\n        MakeGuys()\n        if math.random(1, 3) == 1 then MakeNoise(math.Rand(0.2, 0.6)) end\n      end\n\n      if math.random(1, 120) == 1 then\n        MakeCorpse()\n      end\n\n      if math.random(1, 130) == 1 then\n        MakeCamera()\n      end\n      \n      local vec = VectorRand() * 4000\n      vec.z = math.abs(vec.z)\n      local p = emitter:Add(\"sprites/redglow1\", LocalPlayer():GetPos() + vec)\n    \n      p:SetDieTime(10)\n      p:SetStartAlpha(255)\n      p:SetEndAlpha(0)\n      p:SetStartSize(math.random(100, 300))\n      p:SetRoll(math.Rand(-10, 10))\n      p:SetRollDelta(math.Rand(-10, 10))\n      p:SetEndSize(200)   \n      p:SetCollide(true)\n      p:SetGravity(Vector(0, 0, -20))\n      \n      local vec = VectorRand() * 4000\n      vec.z = math.abs(vec.z)\n      local p = emitter:Add(\"particle/smokesprites_000\" .. math.random(1, 9), LocalPlayer():GetPos() + vec)\n    \n      p:SetDieTime(2)\n      p:SetStartAlpha(20)\n      p:SetEndAlpha(0)\n      p:SetStartSize(math.random(1000, 1600))\n      p:SetRoll(math.Rand(-10, 10))\n      p:SetRollDelta(math.Rand(-1, 1))\n      p:SetEndSize(200)   \n      p:SetCollide(true)\n      p:SetGravity(Vector(0, 0, -20))\n      p:SetColor(255, 0, 0)\n    end\n    \n    for k, v in pairs(Models) do \n      local pos = v:GetPos()\n      pos.z = pos.z + math.sin(CurTime() * v.ZSpeed) * v.ZDist\n      \n      v:SetPos(pos)\n      \n      v:SetAngles(Angle(0, CurTime() * 15 * v.RotDir, 0))\n    end\n    \n    for k, v in pairs(Scrap) do\n      if v:IsValid() then\n        v:SetPos(v:GetPos() - Vector(0, 0, v.Speed))\n        if v:GetPos().z <= LocalPlayer():GetPos().z then v:Remove() end\n      end\n    end\n  end)\nend\n  \n\nlocal function DoHell()\n  if Hell then return end\n  Hell = true\n    \n  EnableHell()\nend\n\nconcommand.Add(\"hellstart\", DoHell)\nconcommand.Add(\"hellend\", End)",
 "title": ""
}