{
 "espireDate": "1H",
 "format": "text",
 "jSonReasons": [
  "lg_en",
  "re_ast1"
 ],
 "key": "8Htsspdd",
 "pasteDate": "Feb 12, 2018, 12:32:06 PM",
 "relevancy": -1.0,
 "relevant": false,
 "text": "RegisterServerEvent('esx_holdupbank:rob')\nAddEventHandler('esx_holdupbank:rob', function(robb)\n\n\tlocal source = source\n\tlocal xPlayer = ESX.GetPlayerFromId(source)\n\tlocal drill = xPlayer.getInventoryItem('drill')\n\tlocal xPlayers = ESX.GetPlayers()\n\t\n\tif Banks[robb] then\n\n\t\tlocal bank = Banks[robb]\n\n\t\tif (os.time() - bank.lastrobbed) < 600 and bank.lastrobbed ~= 0 then\n\n\t\t\tTriggerClientEvent('esx:showNotification', source, _U('already_robbed') .. (2 - (os.time() - bank.lastrobbed)) .. _U('seconds'))\n\t\t\treturn\n\t\tend\n\n\n\t\tlocal cops = 0\n\t\tfor i=1, #xPlayers, 1 do\n \t\tlocal xPlayer = ESX.GetPlayerFromId(xPlayers[i])\n \t\tif xPlayer.job.name == 'police' then\n\t\t\t\tcops = cops + 1\n\t\t\tend\n\t\tend\n\n\n\t\tif rob == false then\n\t\t   \n\t\t   if xPlayer.getInventoryItem('drill').count > 1 then\n\n\t\t\tif(cops >= Config.NumberOfCopsRequired)then\n\n\t\t\t\trob = true\n\t\t\t\tfor i=1, #xPlayers, 1 do\n\t\t\t\t\tlocal xPlayer = ESX.GetPlayerFromId(xPlayers[i])\n\t\t\t\t\tif xPlayer.job.name == 'police' then\n\t\t\t\t\t\t\tTriggerClientEvent('esx:showNotification', xPlayers[i], _U('rob_in_prog') .. bank.nameofbank)\n\t\t\t\t\t\t\tTriggerClientEvent('esx_holdupbank:setblip', xPlayers[i], Banks[robb].position)\n\t\t\t\t\tend\n\t\t\t\tend\n\n\t\t\t\tTriggerClientEvent('esx:showNotification', source, _U('started_to_rob') .. bank.nameofbank .. _U('do_not_move'))\n\t\t\t\tTriggerClientEvent('esx:showNotification', source, _U('alarm_triggered'))\n\t\t\t\tTriggerClientEvent('esx:showNotification', source, _U('hold_pos'))\n\t\t\t\tTriggerClientEvent('esx_holdupbank:currentlyrobbing', source, robb)\n\t\t\t\tBanks[robb].lastrobbed = os.time()\n\t\t\t\trobbers[source] = robb\n\t\t\t\tlocal savedSource = source\n\t\t\t\tSetTimeout(300000, function()\n\n\t\t\t\t\tif(robbers[savedSource])then\n\n\t\t\t\t\t\trob = false\n\t\t\t\t\t\tTriggerClientEvent('esx_holdupbank:robberycomplete', savedSource, job)\n\t\t\t\t\t\tif(xPlayer)then\n\n\t\t\t\t\t\t\txPlayer.addAccountMoney('black_money', bank.reward)\n\t\t\t\t\t\t\tlocal xPlayers = ESX.GetPlayers()\n\t\t\t\t\t\t\tfor i=1, #xPlayers, 1 do\n\t\t\t\t\t\t\t\tlocal xPlayer = ESX.GetPlayerFromId(xPlayers[i])\n\t\t\t\t\t\t\t\tif xPlayer.job.name == 'police' then\n\t\t\t\t\t\t\t\t\t\tTriggerClientEvent('esx:showNotification', xPlayers[i], _U('robbery_complete_at') .. bank.nameofbank)\n\t\t\t\t\t\t\t\t\t\tTriggerClientEvent('esx_holdupbank:killblip', xPlayers[i])\n\t\t\t\t\t\t\t\tend\n\t\t\t\t\t\t\tend\n\t\t\t\t\t\tend\n\t\t\t\t\tend\n\t\t\t\tend)\n\t\t\telse\n\t\t\t\tTriggerClientEvent('esx:showNotification', source, _U('min_two_police') .. Config.NumberOfCopsRequired)\n\t\t\tend\n\t\telse\n\t\t\tTriggerClientEvent('esx:showNotification', source, _U('robbery_already'))\n\t\tend\n\tend\nend)",
 "title": ""
}