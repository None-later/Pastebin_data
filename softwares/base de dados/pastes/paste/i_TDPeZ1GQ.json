{
 "espireDate": "1H",
 "format": "text",
 "jSonReasons": [
  "lg_en"
 ],
 "key": "TDPeZ1GQ",
 "pasteDate": "Feb 28, 2018, 5:41:03 AM",
 "relevancy": 0.0,
 "relevant": false,
 "text": "#include <amxmodx>\n#include <cstrike>\n#include <amxmisc>\n\n#define PLUGIN \"FutureGN PUGMod Match Sequencing\"\n#define VERSION \"0.1\"\n#define AUTHOR \"FutureGN\"\n\nnew gamestate = 0, t_ready_players = 0, ct_ready_players = 0, round_start_counter = 0, round_end_counter = 0, first_a_score = 0, first_b_score = 0, sec_a_score = 0, sec_b_score = 0, total_a_score = 0, total_b_score = 0\n\npublic plugin_init() {\n    register_plugin(PLUGIN, VERSION, AUTHOR)\n\t\n    register_clcmd(\"say /start\", \"start_pug\", ADMIN_ALL, \"Start PUGMod\");\n    register_clcmd(\"say /stop\", \"stop_pug\", ADMIN_ALL, \"Stop PUGMod\");\n    register_clcmd(\"say /ready\", \"ready\");\n    register_concmd(\"pug_team_swap\", \"pug_swap\", ADMIN_ALL);\n\t\n    register_event(\"TeamScore\", \"team_score\", \"a\");\n    register_logevent(\"EventRoundStart\", 2, \"1=Round_Start\");\n    register_logevent(\"EventRoundEnd\", 2, \"1=Round_End\");\n}\n\npublic client_putinserver(id)\n{\n\tset_task(5.0, \"clientCmds\")\n}\n\npublic clientCmds (id)\n{\n\tclient_cmd(id, \"rate 100000\")\n\tclient_cmd(id, \"developer 1\")\n\tclient_cmd(id, \"fps_overide 1\")\n\tclient_cmd(id, \"fps_max 999\")\n\tclient_cmd(id, \"ex_interp 0.01\")\n\tclient_cmd(id, \"cl_updaterate 101\")\n\tclient_cmd(id, \"cl_cmdrate 101\")\n}\n\npublic start_pug(id) {\n    new players = get_playersnum()\n\t\n    if(gamestate >= 1 ) {\n\tserver_cmd(\"say GAME in progress. Type /stop to cancel current game\")\n\treturn PLUGIN_HANDLED\n\t}\n\t\n    if(players <= 9) {\n\tserver_cmd(\"say There is not enough people to start a PUG. 10 people required.\");\n\treturn PLUGIN_HANDLED\n\t}\n\n    if(players >= 10) {\n\tgamestate = 1\n\tserver_cmd(\"pug_spec\")\n\tserver_cmd(\"pug_team_limit 1\")\n\tserver_cmd(\"sv_alltalk 1\")\n    server_cmd(\"mp_roundtime 6\")\n    server_cmd(\"sv_restart 1\")\t\n\tclient_print_color(id, print_team_red, \"^4 .::| FutureGN |::. ^1 All Players have been moved to Spectator. ^3 Alltalk is ON ^1 until the Game goes Live.\")\n\tclient_print_color(id, print_team_red, \"^4 .::| FutureGN |::. ^1 First two people to join a team are captains.\")\n\tclient_print_color(id, print_team_grey,\"^4 .::| FutureGN |::. ^3 Both Captains must type /ready to commence the game\")\n\treturn PLUGIN_HANDLED\n    }\nreturn PLUGIN_CONTINUE;   \n}\n\npublic ready(id)\n{\n\tif(gamestate <= 3)\n\t{\n\t\tif(cs_get_user_team(id) == CS_TEAM_T)\n\t\t{\n\t        t_ready_players++\n\t\t}   \n\t\t\n\t\t\n\t\tif(cs_get_user_team(id) == CS_TEAM_CT)\n\t\t{\n\t        ct_ready_players++\n\t    }   \n\t\t\n\t\t\n\t\tif(gamestate == 1 && t_ready_players == 1 && ct_ready_players == 1 )\n\t\t{\n\t\t\tset_task(0.1, \"knife_round\")\n\t\t}\n\t\t\n\t\tif(gamestate == 3 && t_ready_players == 5 && ct_ready_players == 5) {\n\t        set_task(0.1, \"liveonthree\")\n\t    }\n\t}\n}\n\npublic EventRoundStart(id)\n{\n    round_start_counter++\n\ttotal_a_score = first_a_score + sec_a_score\n    total_b_score = first_b_score + sec_b_score\n\n\t//* KNIFE ROUND *//\n    if(gamestate == 2 && round_start_counter > 1) {\n        if(first_a_score == 1) {\n        client_print_color(id, print_team_blue, \"^4 .::| FutureGN |::. ^1 The ^3CT Captain ^4won. ^1 You pick the first teammate.\")\n        }\n        if(first_b_score == 1) {\n        client_print_color(id, print_team_red, \"^4 .::| FutureGN |::. ^1 The ^3T Captain ^4won. ^1 You pick the first teammate.\")\n        }\n\t    gamestate = 3\n\t    server_cmd(\"pug_team_limit 5\")\n\t    client_print_color(id, print_team_red, \"^4 .::| FutureGN |::. ^1Game will go ^3LIVE ^1 once all 10 players type ^3 /ready\")\n\t\n\t    t_ready_players = 0\n\t    ct_ready_players = 0\n    }\n\t\n\t//* ROUND START COUNTER AND SCORE PRINT EVERY ROUND BETWEEN 1 AND 42  *//\n\tif(gamestate >= 4 && round_start_counter <= 42) {\n        client_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3Round ^1: ^4 %d - ^3 Team A ^1 : ^4 %d ^1- ^3 Team B ^1 : ^4 %d\",round_start_counter, total_a_score, total_b_score)\n\t}\n\t\n\tif(gamestate == 5 && round_start_counter == 16) {\n\t    client_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3 First Half Score: ^3 Team A ^1 : ^4 %d ^1 - ^3 Team B ^1: ^4 %d\", first_a_score, first_b_score)\t\n\t    client_print_color(id, print_team_grey, \"Second Half is now LIVE.\")\n\t}\n\t\n\tif(gamestate == 5 && round_start_counter <= 31 && round_end_counter <= 30) {\n\t    \n        if(total_a_score == 16) {\n\t\tclient_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3Team A WON the Match.\")\n\t\tset_task(0.1, \"stop_pug\")\n        }\n        \n\t\tif(total_b_score == 16) {\n\t\tclient_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3 Team B WON the Match.\")\n\t\tset_task(0.1, \"stop_pug\")\n        }\n\t}\n    \n\tif(gamestate == 5 && round_start_counter == 31)\n\tif(total_a_score == 15 && total_b_score == 15) {\n\tgamestate = 6\n\tround_start_counter = 30\n\tround_end_counter = 30\t\n\tfirst_a_score = 0\n\tfirst_b_score =0\n\tsec_a_score = 0\n\tsec_b_score = 0\n\ttotal_a_score = 0\n\ttotal_b_score = 0 \n\t\n    server_cmd(\"say The match is tied. Starting Overtime.\")\n\tserver_cmd(\"mp_startmoney 10000\")\n\n\tserver_cmd(\"sv_restart 1\")\n    }\n\t\n\tif(gamestate == 6 && round_start_counter == 31) {\n\t\tclient_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3 Overtime One Started\")\t\t\n\t\t}\t\n\t\n\tif(gamestate == 7 && round_start_counter == 34) {\n\t    client_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3 Overtime One 2nd Half is now LIVE.\")\n\t}\n\t\n\tif(gamestate == 7 && round_start_counter == 36) {\n\t\tclient_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3 TOTAL SCORE - Team A: %d Team B: %d\", total_a_score, total_b_score)\n\t\t\n\t\tif(total_a_score == 3 && total_b_score == 3) {\n\t    gamestate = 8\n\t    round_start_counter = 35\n\t    round_end_counter = 35\t\n\t    first_a_score = 0\n\t    first_b_score =0\n\t    sec_a_score = 0\n\t    sec_b_score = 0\n\t    total_a_score = 0\n\t    total_b_score = 0 \n\t\n        server_cmd(\"say The match is tied. Starting Overtime.\")\n\t    server_cmd(\"mp_startmoney 10000\")\n\n\t    server_cmd(\"sv_restart 1\")\n        }\t\t\t\n\t}\n\t\n\tif(gamestate == 7 && round_start_counter <= 36 && round_end_counter <= 35) {\n\t    \n        if(total_a_score == 4) {\n\t\tclient_print_color(id, print_team_grey, \"Team A WON the Match.\")\n\t\tset_task(0.1, \"stop_pug\")\n        }\n        \n\t\tif(total_b_score == 4) {\n\t\tclient_print_color(id, print_team_grey, \"Team B WON the Match.\")\n\t\tset_task(0.1, \"stop_pug\")\n        }\t\n\t}\n}  \n\npublic EventRoundEnd(id) \n{\n    round_end_counter++\n\t\n\tif(gamestate == 4 && round_end_counter == 15) {\n        client_print_color(id, print_team_grey, \"First Half ended. Teams will automatically swap.\")\n\t\tset_task(0.1, \"second_half\")\n    }\n\n    if(gamestate == 5 && round_end_counter == 30) {\n        client_print_color(id, print_team_grey, \"Second Half ended.\")\n    }\n\t\n    if(gamestate == 6 && round_end_counter == 33) {\n        client_print_color(id, print_team_grey, \"Overtime 1 - 1st Half ended. Teams will automatically swap.\")\n\t\tset_task(0.1, \"overtime_two\")\n    }\n\t\n    if(gamestate == 7 && round_end_counter == 36) {\n        client_print_color(id, print_team_grey, \"Overtime 1 - 2nd Half ended.\")\n\t\tset_task(0.1, \"overtime_three\")\n    }\t\n\t\n    if(gamestate == 8 && round_end_counter == 39) {\n        client_print_color(id, print_team_grey, \"Overtime 2 - 1st Half ended. Teams will automatically swap.\")\n\t\tset_task(0.1, \"overtime_four\")\n    }\n\t\n    if(gamestate == 9 && round_end_counter == 42) {\n        client_print_color(id, print_team_grey, \"Overtime 2 - 2nd Half ended.\")\n\t\tset_task(0.1, \"overtime_five\")\n    }\t\n}\n\n\n\n\n\n\n\npublic team_score()\n{ \n    \n\tnew team[32]\n    read_data(1,team,32)\n\t\n    if(gamestate == 2 || gamestate == 4 || gamestate == 7 || gamestate == 9 || gamestate == 11) {\n    if (equal(team,\"CT\"))\n    { \n        first_a_score = read_data(2)\n    }\n    else if (equal(team,\"TERRORIST\"))\n    {\n        first_b_score = read_data(2)\n    }\n\t}\n\n    if(gamestate == 5 || gamestate == 6 || gamestate == 8 || gamestate == 10) {    \n    if (equal(team,\"TERRORIST\"))\n    { \n        sec_a_score = read_data(2)\n    }\n    else if (equal(team,\"CT\"))\n    {\n        sec_b_score = read_data(2)\n    }\n\t}\n\t\n\t\n    return PLUGIN_CONTINUE\n}\n\npublic pug_swap()\n{        \n    SwapTeams();\n}\n\nSwapTeams()\n{\n    static iMaxPlayers;\n    if(!iMaxPlayers)\n        iMaxPlayers = get_maxplayers();\n    \n    for(new id = 1 ; id <= iMaxPlayers ; id++)\n    {\n        if(!is_user_connected(id))\n            continue;\n        \n        if(0 < get_user_team(id) < 3)\n            cs_set_user_team(id, _:(3 - get_user_team(id)));\n    }\n}\n\npublic knife_round(id)\n{\n    gamestate = 2\t\t\n    server_cmd(\"sv_restart 1\")\t\n    client_print_color(id, print_team_blue, \"^4Knife Round started. ^3Winner picks the first teammate.\")\n\t\n\tround_start_counter = 0\n\tround_end_counter = 0\n\t\n    return PLUGIN_CONTINUE;\n}\n\t\npublic liveonthree(id)\n{\n\tgamestate = 4\n    server_cmd(\"mp_roundtime 1.75\")\t\n\tserver_cmd(\"sv_alltalk 0\")\n    server_cmd(\"mp_mp_buytime 0.25 \")\t\n\tserver_cmd(\"mp_c4timer 35\")\n\tserver_cmd(\"mp_forcecamera 2\")\n    server_cmd(\"mp_forcechasecam 2\")\t\n\tserver_cmd(\"sv_airaccelerate 100\")\n\tserver_cmd(\"sv_restart 1\")\t\n\t\n\tserver_cmd(\"sv_restart 1\")\n\tclient_print_color(id, print_team_red, \"^3 .::| FutureGN |::. ^4 First Half is now LIVE.\")\n\t\n\tround_end_counter = 0\n\tround_start_counter = 0\n\tfirst_a_score = 0\n\tfirst_b_score = 0\t\n\t\n\treturn PLUGIN_CONTINUE\n}\n\npublic second_half()\n{\n    gamestate = 5\n\tset_task(0.1, \"pug_swap\")\n\tserver_cmd(\"sv_restart 1\")\n\t\n    return PLUGIN_CONTINUE;\n}\n\npublic overtime_two(id)\n{    \n    gamestate = 7\n\t\n\tset_task(0.1, \"pug_swap\")\n\tserver_cmd(\"sv_restart 1\")\n\tclient_print_color(id, print_team_red, \"^4 .::| FutureGN |::. Overtime One 2nd Half is now LIVE.\")\n}\n\npublic stop_pug(id) {\n\tclient_print_color(id, print_team_grey, \"^4 .::| FutureGN |::. ^3 The Match is Over !! Final Score: Team A: %d Team B: %d\", total_a_score, total_b_score)\n\tserver_cmd(\"sv_alltalk 1\")\n    server_cmd(\"exec normal.cfg\")\n\tserver_cmd(\"sv_restart 1\")\n\tserver_cmd(\"pug_team_limit 32\")\n\tgamestate = 0\n\tround_end_counter = 0\n\tround_start_counter = 0\n\tfirst_a_score = 0\n\tfirst_b_score = 0\n\tt_ready_players = 0\n\tct_ready_players = 0\n\n\treturn PLUGIN_HANDLED\n}",
 "title": ""
}