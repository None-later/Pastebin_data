{
 "espireDate": "N",
 "format": "dos",
 "jSonReasons": [
  "kw_down",
  "kw_error",
  "lg_en",
  "re_url"
 ],
 "key": "shmMxkaD",
 "pasteDate": "Feb 21, 2018, 9:30:17 AM",
 "relevancy": 2.0,
 "relevant": false,
 "text": "@echo off\nSETLOCAL EnableDelayedExpansion\nmode con cols=70 lines=15\nchcp 65001 >nul\ntitle RandomWeb ^| By Aypleck\ncolor f0\n\n:: #### CHECKING WINDOWS VERSION ####\n\nfor /f \"tokens=4-5 delims=. \" %%i in ('ver') do (\n\tif \"%%i\" NEQ \"10\" (\n\t\tcall :headerwarn\n\t\techo [%time%] DETECTED WINDOWS VERSION : %%i\n\t\techo [%time%] This script has been created for windows 10, You may encounter issues by running it on other versions of windows.\n\t\tpause>nul\n\t\tcolor f0\n\t)\n)\n\n\n:: #### CREATING CONFIG FILE ####\n\nif not exist \"%~n0.ini\" (\n    echo sitelistpath=sitelist.txt >%~n0.ini\n\techo maxping=500 >>%~n0.ini\n)\n\n:: #### DOWNLOADING http-ping.exe ####\nif not exist \"http-ping.exe\" (\n\tcall :headerwarn\n\techo [%time%] RandomWeb needs http-ping.exe to work, press any key to download it from coretechnologies.com.\n\tpause>nul\n\tpowershell -Command \"Invoke-WebRequest https://www.coretechnologies.com/products/http-ping/http-ping.exe -OutFile http-ping.exe\"\n)\n:: #### PARSING CONFIG FILE ####\ncall :readconfig\n\n:: #############\n:: # MAIN MENU #\n:: #############\n\n:mainMenu\ncolor f0\ncall :header\necho 1. Search for websites\necho 2. Manage discovered sites\necho 3. Change options\necho 0. Exit\n\nchoice /c 1230 /n >nul\n\nif !errorlevel! EQU 1 goto :searchMenu\nif !errorlevel! EQU 2 goto :manageMenu\nif !errorlevel! EQU 3 goto :optionsMenu\nif !errorlevel! EQU 4 exit\n\n:: ##################\n:: # SEARCH SECTION #\n:: ##################\n\n:searchMenu\ncall :headersearch\n\necho [%time%] Search started.\n:searchloop\nset /a ip1=\"%random%%%254\" \nset /a ip2=\"%random%%%254\" \nset /a ip3=\"%random%%%254\" \nset /a ip4=\"%random%%%254\" \nset host=%ip1%.%ip2%.%ip3%.%ip4%\nping -n 1 %host% -w !maxping! >nul\nif !errorlevel! EQU 0 (\n\tREM PortQry.exe -n %host% -e 80 -q\n\thttp-ping %host% -n 1 -e -w 1 -s>nul\n\tif !errorlevel! GTR 200 (\n\t\tif !errorlevel! LSS 399 (\n\t\t\tfor /f %%l in (!sitelistpath!) DO ( \n\t\t\t\tif %%l EQU %host% ( goto :a )\n\t\t\t)\n\t\t\techo %host% >>!sitelistpath!  \n\t\t\techo [%time%] host %host% responded with code !errorlevel!\n\t\t\t)\n\t\t)\n\t)\n)\ngoto :searchloop\n\n\n\n:: ##################\n:: # MANAGE SECTION #\n:: ##################\n\n:manageMenu\ncall :headermanage\n::Showing file states\n::Compute Number of sites\nset sitenbr=0\nfor /f %%l in (!sitelistpath!) do (set /a sitenbr=!sitenbr!+1)\n::Compute size of file\nfor /f \"tokens=3\" %%o in ('dir /-c ^| findstr \"!sitelistpath!\"') do (set size=%%o)\n::Echo stats\necho !sitelistpath! stores !sitenbr! sites, the file weight !size! octets.\n\necho 1. Open site list file.\necho 2. Open all sites in a web browser.\necho 3. Clear sites list.\necho 0. Back\nchoice /c 1230 /n\n\n:: Open site list\nif %errorlevel% EQU 1 (\n\tcall :headermanage\n\tstart !sitelistpath!\n\techo !sitelistpath! has been opened in notepad.\n\tpause>nul\n\tgoto :manageMenu\n)\n\n:: Open site list in a browser\nif %errorlevel% EQU 2 (\n\tcall :headermanage\n\tfor /f %%l in (!sitelistpath!) do (\n\t\tstart \"\" \"http://%%l\"\n\t)\n\techo All sites has been opened in you default browser.\n\tpause>nul\n\tgoto :manageMenu\n)\n\n:: Clear site list\nif %errorlevel% EQU 3 (\n\tcall :headermanage\n\tbreak>!sitelistpath!\n\techo File !sitelistpath! has been cleared.\n\tpause>nul\n\tgoto manageMenu\n)\n::Back\nif %errorlevel% EQU 4 (\n\tgoto :mainMenu\n)\n\ngoto :mainMenu\n\n:: ###################\n:: # OPTIONS SECTION #\n:: ###################\n\n:optionsMenu\ncall :headeroptions\necho 1. Change site list file path : !sitelistpath!\necho 2. Change maximum latency for an host during search : !maxping!\necho 0. Back\nchoice /c 012 /n\n\nif !errorlevel! EQU 1 goto :mainMenu\n\nif !errorlevel! EQU 2 (\n\tcls\n\tcall :headeroptions\n\tset /p newpath=Where do you want to store found sites : \n\tcall :setSitelistpath !newpath!\n\tgoto :optionsMenu\n)\n\nif !errorlevel! EQU 3 (\n\tcls\n\tcall :headeroptions\n\tset /p newPing=Set the max ping for a host before considering it as down : \n\tcall :setMaxping !newPing!\n\tgoto :optionsMenu\n)\n\n\n\n:: #############\n:: # FUNCTIONS #\n:: #############\n\n:readconfig\n\n:: #### READING CONFIG FILE ####\n \n:: For each line of the config file\nfor /f \"delims= tokens=*\" %%l in (%~n0.ini) do (\n    :: Get the word behind the charcter \"=\"\n    for /f \"delims== tokens=1\" %%k in (\"%%l\") do (\n        :: Get the word after the \"=\"\n        for /f \"delims== tokens=2\" %%v in (\"%%l\") do (\n            :: If there is something after the \"=\"\n            if %errorlevel% == 0 (\n                :: Set a variable with the name of the word behind the space and with the value of the word after the space\n                set \"%%k=%%v\"\n            )\n        )\n    )\n)\ngoto :EOF\nrem ## OPTION MODIFYING FUCNTIONS ##\n\n:setSitelistpath\necho sitelistpath=%1>%~n0.ini\necho maxping=!maxping!>>%~n0.ini\nset sitelistpath=%1\nGOTO :eof\n\n:setMaxping\necho sitelistpath=!sitelistpath!>%~n0.ini\necho maxping=%1>>%~n0.ini\nset maxping=%1\nGOTO :eof\n\nrem ## GRAPHICALS FUCNTIONS ##\n\n:header\ncls\necho        \t\t\necho        \t\t         RandomWeb by Aypleck        \necho        \t\t\necho.\necho.\nGOTO :eof\n\n:headersearch\ncls\necho        \t\t\necho        \t\t     Search for random websites      \necho        \t\t\necho.\necho.\nGOTO :eof\n\n:headermanage\ncls\necho        \t\t\necho        \t\t     Manage your website list        \necho        \t\t\necho.\necho.\nGOTO :eof\n\n\n:headeroptions\ncls\necho                \necho                              OPTIONS                \necho                \necho.\necho.\nGOTO :eof\n \n:headerwarn\ncls\ncolor 06\necho                \necho                              WARNING                \necho                \necho.\necho.\nGOTO :eof\n \n:headererror\ncls\ncolor 0c\necho                \necho                            FATAL ERROR              \necho                \necho.\necho.\nGOTO :eof",
 "title": "RandomWeb by Aypleck"
}