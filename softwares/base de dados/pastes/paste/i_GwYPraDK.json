{
 "espireDate": "N",
 "format": "csharp",
 "jSonReasons": [
  "re_sql",
  "lg_en"
 ],
 "key": "GwYPraDK",
 "pasteDate": "Feb 17, 2018, 2:47:49 PM",
 "relevancy": 0.0,
 "relevant": false,
 "text": "using System;\nusing System.Collections.Generic;\nusing System.Data.SqlClient;\nusing System.Configuration;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n \nnamespace Ergasia_2017\n{\n    public partial class TrueOrFalse : System.Web.UI.Page\n    {\n        SqlConnection conn;\n        SqlCommand com;\n\t\tSqlCommand idcommand;\n \n        public TrueOrFalse()\n        {\n            conn = new SqlConnection();\n            conn.ConnectionString = ConfigurationManager.ConnectionStrings[\"RegistrationConnectionString\"].ToString();\n            com = new SqlCommand();\n\t\t\tidcommand = new SqlCommand();\n        }\n        protected void Page_Load(object sender, EventArgs e)\n        {\n \n        }\n \n        string Answer1, Answer2, Answer3, Answer4, Answer5,exam_id;\n        int id;\n \n        protected void Button1_Click(object sender, EventArgs e)\n        {\n \n            if (GrammarRb1.Checked)\n            {\n                exam_id = \"Grammar\";\n            }\n            else if (VocabularyRb2.Checked)\n            {\n                exam_id = \"Vocabulary\";\n            }\n            else if (ReadingRb3.Checked)\n            {\n                exam_id = \"Reading\";\n            }\n            else if (WrittingRb4.Checked)\n            {\n                exam_id = \"Writting\";\n            }\n \n \n            if (TrueRb1.Checked)\n            {\n                Answer1 = \"True\";\n            }\n            else if (FalseRb1.Checked)\n            {\n                Answer1 = \"False\";\n            }\n \n            if (TrueRb2.Checked)\n            {\n                Answer2 = \"True\";\n            }\n            else if (FalseRb2.Checked)\n            {\n                Answer2 = \"False\";\n            }\n \n            if (TrueRb3.Checked)\n            {\n                Answer3 = \"True\";\n            }\n            else if (FalseRb3.Checked)\n            {\n                Answer3 = \"False\";\n            }\n \n            if (TrueRb4.Checked)\n            {\n                Answer4 = \"True\";\n            }\n            else if (FalseRb4.Checked)\n            {\n                Answer4 = \"False\";\n            }\n \n            if (TrueRb5.Checked)\n            {\n                Answer5 = \"True\";\n            }\n            else if (FalseRb5.Checked)\n            {\n                Answer5 = \"False\";\n            }\n \n \n            try\n            {\n                conn.Open();\n\t\t\t\t\n\t\t\t\tidcommand.CommandText = \"Select MAX(id) from [Char1]\";\n\t\t\t\tidcommand.Connection = connl;\n\t\t\t\tid= idcommand.ExecuteNonQuery();\n \n\t\t\t\t\n                com.CommandText = \"insert into [Question2](Question1,Answer1,Question2,Answer2,Question3,Answer3,Question4,Answer4,Question5,Answer5,exam_title,exam_id,id)\" +\n                    \"values(@q1,@a1,@q2,@a2,@q3,@a3,@q4,@a4,@q5,@a5,@exti,@exid,@id)\";\n \n                com.Parameters.AddWithValue(\"@q1\", q1txt.Text);\n                com.Parameters.AddWithValue(\"@a1\", Answer1);\n                com.Parameters.AddWithValue(\"@q2\", q2txt.Text);\n                com.Parameters.AddWithValue(\"@a2\", Answer2);\n                com.Parameters.AddWithValue(\"@q3\", q3txt.Text);\n                com.Parameters.AddWithValue(\"@a3\", Answer3);\n                com.Parameters.AddWithValue(\"@q4\", q4txt.Text);\n                com.Parameters.AddWithValue(\"@a4\", Answer4);\n                com.Parameters.AddWithValue(\"@q5\", q5txt.Text);\n                com.Parameters.AddWithValue(\"@a5\", Answer5);\n                com.Parameters.AddWithValue(\"@exti\", titletxt.Text);\n                com.Parameters.AddWithValue(\"@exid\", exam_id);\n                com.Parameters.AddWithValue(\"@id\", id);\n \n\t\t\t\t\n\t\t\t\t\n \n \n                com.Connection = conn;\n                int a = com.ExecuteNonQuery();\n                if (a > 0)\n                {\n                    resultlbl.Text = \"The exam is successfully added\";\n                }\n                else\n                {\n                    resultlbl.Text = \"Error in Exam\";\n \n                }\n            }\n            catch (Exception ex)\n            {\n                resultlbl.Text = \"Error in Connection\" + ex.Message;\n            }\n            finally\n            {\n                conn.Close();\n            }\n        }\n    }\n   \n}",
 "title": ""
}